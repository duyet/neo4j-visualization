(window.webpackJsonpNeo4jVisualization=window.webpackJsonpNeo4jVisualization||[]).push([[1],{112:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.utf8=t.HostNameResolver=t.Channel=t.alloc=void 0;var i=r(n(203)),o=r(n(332)),a=r(n(333)),u=r(n(335));t.alloc=function(e){return new i.default(e)};var s=o.default;t.Channel=s;var c=a.default;t.HostNameResolver=c;var l=u.default;t.utf8=l},113:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.ALL=void 0;var i=r(n(6)),o=r(n(8)),a=n(62),u=n(51),s=n(40);t.ALL=-1;var c=function(){function e(t,n,r){(0,i.default)(this,e),this.signature=t,this.fields=n,this.toString=r}return(0,o.default)(e,null,[{key:"init",value:function(t,n){return new e(1,[t,n],(function(){return"INIT ".concat(t," {...}")}))}},{key:"run",value:function(t,n){return new e(16,[t,n],(function(){return"RUN ".concat(t," ").concat(JSON.stringify(n))}))}},{key:"pullAll",value:function(){return h}},{key:"reset",value:function(){return d}},{key:"hello",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null,i=Object.assign({user_agent:t},n);return null!=r&&(i.routing=r),new e(1,[i],(function(){return"HELLO {user_agent: '".concat(t,"', ...}")}))}},{key:"begin",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.bookmark,r=t.txConfig,i=t.database,o=t.mode,a=l(n,r,i,o);return new e(17,[a],(function(){return"BEGIN ".concat(JSON.stringify(a))}))}},{key:"commit",value:function(){return v}},{key:"rollback",value:function(){return _}},{key:"runWithMetadata",value:function(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},i=r.bookmark,o=r.txConfig,a=r.database,u=r.mode,s=l(i,o,a,u);return new e(16,[t,n,s],(function(){return"RUN ".concat(t," ").concat(JSON.stringify(n)," ").concat(JSON.stringify(s))}))}},{key:"goodbye",value:function(){return p}},{key:"pull",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.stmtId,r=void 0===n?-1:n,i=t.n,o=void 0===i?-1:i,a=f(r||-1,o||-1);return new e(63,[a],(function(){return"PULL ".concat(JSON.stringify(a))}))}},{key:"discard",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.stmtId,r=void 0===n?-1:n,i=t.n,o=void 0===i?-1:i,a=f(r||-1,o||-1);return new e(47,[a],(function(){return"DISCARD ".concat(JSON.stringify(a))}))}}]),e}();function l(e,t,n,r){var i={};return e.isEmpty()||(i.bookmarks=e.values()),t.timeout&&(i.tx_timeout=t.timeout),t.metadata&&(i.tx_metadata=t.metadata),n&&(i.db=(0,s.assertString)(n,"database")),r===a.ACCESS_MODE_READ&&(i.mode="r"),i}function f(e,t){var n={n:(0,u.int)(t)};return-1!==e&&(n.qid=(0,u.int)(e)),n}t.default=c;var h=new c(63,[],(function(){return"PULL_ALL"})),d=new c(15,[],(function(){return"RESET"})),v=new c(18,[],(function(){return"COMMIT"})),_=new c(19,[],(function(){return"ROLLBACK"})),p=new c(2,[],(function(){return"GOODBYE"}))},114:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.WRITE=t.READ=t.Driver=void 0;var i=r(n(6)),o=r(n(8)),a=n(22),u=(r(n(204)),r(n(90))),s=r(n(338)),c=r(n(344)),l=n(62),f=r(n(208)),h=n(207),d=r(n(159)),v=r(n(346)),_=n(113),p=n(40),y=l.ACCESS_MODE_READ;t.READ=y;var m=l.ACCESS_MODE_WRITE;t.WRITE=m;var g=0,b=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};(0,i.default)(this,e),k(o),this._id=g++,this._address=t,this._userAgent=n,this._authToken=r,this._config=o,this._log=f.default.create(o),this._connectionProvider=null,this._afterConstruction()}return(0,o.default)(e,[{key:"verifyConnectivity",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.database,n=void 0===t?"":t,r=this._getOrCreateConnectionProvider(),i=new c.default(r);return i.verify({database:n})}},{key:"supportsMultiDb",value:function(){return this._getOrCreateConnectionProvider().supportsMultiDb()}},{key:"supportsTransactionConfig",value:function(){return this._getOrCreateConnectionProvider().supportsTransactionConfig()}},{key:"_supportsRouting",value:function(){return!1}},{key:"_isEncrypted",value:function(){return this._config.encrypted===p.ENCRYPTION_ON}},{key:"_getTrust",value:function(){return this._config.trust}},{key:"session",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.defaultAccessMode,n=void 0===t?m:t,r=e.bookmarks,i=e.database,o=void 0===i?"":i,a=e.fetchSize;return this._newSession({defaultAccessMode:n,bookmarkOrBookmarks:r,database:o,reactive:!1,fetchSize:w(a,this._config.fetchSize)})}},{key:"rxSession",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.defaultAccessMode,n=void 0===t?m:t,r=e.bookmarks,i=e.database,o=void 0===i?"":i,a=e.fetchSize;return new v.default({session:this._newSession({defaultAccessMode:n,bookmarks:r,database:o,reactive:!0,fetchSize:w(a,this._config.fetchSize)}),config:this._config})}},{key:"close",value:function(){return this._log.info("Driver ".concat(this._id," closing")),this._connectionProvider?this._connectionProvider.close():Promise.resolve()}},{key:"_afterConstruction",value:function(){this._log.info("Direct driver ".concat(this._id," created for server address ").concat(this._address))}},{key:"_createConnectionProvider",value:function(e,t,n){return new s.default({id:this._id,config:this._config,log:this._log,address:e,userAgent:t,authToken:n})}},{key:"_newSession",value:function(t){var n=t.defaultAccessMode,r=t.bookmarkOrBookmarks,i=t.database,o=t.reactive,a=t.fetchSize,s=e._validateSessionMode(n),c=this._getOrCreateConnectionProvider(),l=r?new u.default(r):u.default.empty();return new d.default({mode:s,database:i,connectionProvider:c,bookmark:l,config:this._config,reactive:o,fetchSize:a})}},{key:"_getOrCreateConnectionProvider",value:function(){return this._connectionProvider||(this._connectionProvider=this._createConnectionProvider(this._address,this._userAgent,this._authToken)),this._connectionProvider}}],[{key:"_validateSessionMode",value:function(e){var t=e||m;if(t!==l.ACCESS_MODE_READ&&t!==l.ACCESS_MODE_WRITE)throw(0,a.newError)("Illegal session mode "+t);return t}}]),e}();function k(e){e.maxConnectionLifetime=E(e.maxConnectionLifetime,36e5),e.maxConnectionPoolSize=E(e.maxConnectionPoolSize,h.DEFAULT_MAX_SIZE),e.connectionAcquisitionTimeout=E(e.connectionAcquisitionTimeout,h.DEFAULT_ACQUISITION_TIMEOUT),e.fetchSize=w(e.fetchSize,1e3)}function E(e,t){var n=parseInt(e,10);return n>0||0===n?n:n<0?Number.MAX_SAFE_INTEGER:t}function w(e,t){var n=parseInt(e,10);if(n>0||n===_.ALL)return n;if(0===n||n<0)throw new Error("The fetch size can only be a positive value or -1 for ALL. However fetchSize = "+n);return t}t.Driver=b;var I=b;t.default=I},134:function(e,t,n){"use strict";var r=n(61),i=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(6)),a=i(n(8)),u=r(n(40)),s=n(51),c=n(22),l=function(){function e(t){(0,o.default)(this,e),function(e){e&&u.assertObject(e,"Transaction config")}(t),this.timeout=function(e){if(u.isObject(e)&&(e.timeout||0===e.timeout)){u.assertNumberOrInteger(e.timeout,"Transaction timeout");var t=(0,s.int)(e.timeout);if(t.isZero())throw(0,c.newError)("Transaction timeout should not be zero");if(t.isNegative())throw(0,c.newError)("Transaction timeout should not be negative");return t}return null}(t),this.metadata=function(e){if(u.isObject(e)&&e.metadata){var t=e.metadata;if(u.assertObject(t),0!==Object.keys(t).length)return t}return null}(t)}return(0,a.default)(e,[{key:"isEmpty",value:function(){return Object.values(this).every((function(e){return null==e}))}}],[{key:"empty",value:function(){return f}}]),e}();t.default=l;var f=new l({})},14:function(e,t,n){"use strict";(function(e){var r=n(5),i=n(61);Object.defineProperty(t,"__esModule",{value:!0}),t.driver=g,Object.defineProperty(t,"int",{enumerable:!0,get:function(){return o.int}}),Object.defineProperty(t,"isInt",{enumerable:!0,get:function(){return o.isInt}}),Object.defineProperty(t,"Neo4jError",{enumerable:!0,get:function(){return u.Neo4jError}}),Object.defineProperty(t,"isPoint",{enumerable:!0,get:function(){return p.isPoint}}),Object.defineProperty(t,"isDate",{enumerable:!0,get:function(){return y.isDate}}),Object.defineProperty(t,"isDateTime",{enumerable:!0,get:function(){return y.isDateTime}}),Object.defineProperty(t,"isDuration",{enumerable:!0,get:function(){return y.isDuration}}),Object.defineProperty(t,"isLocalDateTime",{enumerable:!0,get:function(){return y.isLocalDateTime}}),Object.defineProperty(t,"isLocalTime",{enumerable:!0,get:function(){return y.isLocalTime}}),Object.defineProperty(t,"isTime",{enumerable:!0,get:function(){return y.isTime}}),t.default=t.temporal=t.spatial=t.error=t.session=t.types=t.logging=t.auth=t.integer=void 0;var o=i(n(51)),a=n(242),u=n(22),s=r(n(199)),c=r(n(200)),l=r(n(201)),f=n(114),h=r(n(349)),d=r(n(362)),v=n(40),_=r(n(263)),p=n(254),y=n(206),m=r(n(210));function g(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,v.assertString)(e,"Bolt URL");var r,i=_.default.parseDatabaseUrl(e),o=!1,a=!1;switch(i.scheme){case"bolt":break;case"bolt+s":a=!0,r="TRUST_SYSTEM_CA_SIGNED_CERTIFICATES";break;case"bolt+ssc":a=!0,r="TRUST_ALL_CERTIFICATES";break;case"neo4j":o=!0;break;case"neo4j+s":a=!0,r="TRUST_SYSTEM_CA_SIGNED_CERTIFICATES",o=!0;break;case"neo4j+ssc":a=!0,r="TRUST_ALL_CERTIFICATES",o=!0;break;default:throw new Error("Unknown scheme: ".concat(i.scheme))}if(a){if("encrypted"in n||"trust"in n)throw new Error("Encryption/trust can only be configured either through URL or config, not both");n.encrypted=v.ENCRYPTION_ON,n.trust=r}if((t=t||{}).scheme=t.scheme||"none",n.userAgent=n.userAgent||k,o)return new h.default(m.default.fromUrl(i.hostAndPort),i.query,n.userAgent,t,n);if(!(0,v.isEmptyObjectOrNull)(i.query))throw new Error("Parameters are not supported with none routed scheme. Given URL: '".concat(e,"'"));return new f.Driver(m.default.fromUrl(i.hostAndPort),n.userAgent,t,n)}var b={basic:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:void 0;return n?{scheme:"basic",principal:e,credentials:t,realm:n}:{scheme:"basic",principal:e,credentials:t}},kerberos:function(e){return{scheme:"kerberos",principal:"",credentials:e}},custom:function(e,t,n,r){var i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:void 0;return i?{scheme:r,principal:e,credentials:t,realm:n,parameters:i}:{scheme:r,principal:e,credentials:t,realm:n}}};t.auth=b;var k="neo4j-javascript/"+d.default,E={console:function(e){function t(t){return e.apply(this,arguments)}return t.toString=function(){return e.toString()},t}((function(t){return{level:t,logger:function(t,n){return console.log("".concat(e.Date.now()," ").concat(t.toUpperCase()," ").concat(n))}}}))};t.logging=E;var w={Node:a.Node,Relationship:a.Relationship,UnboundRelationship:a.UnboundRelationship,PathSegment:a.PathSegment,Path:a.Path,Result:s.default,ResultSummary:c.default,Record:l.default,Point:p.Point,Date:y.Date,DateTime:y.DateTime,Duration:y.Duration,LocalDateTime:y.LocalDateTime,LocalTime:y.LocalTime,Time:y.Time,Integer:o.default};t.types=w;var I={READ:f.READ,WRITE:f.WRITE};t.session=I;var O={SERVICE_UNAVAILABLE:u.SERVICE_UNAVAILABLE,SESSION_EXPIRED:u.SESSION_EXPIRED,PROTOCOL_ERROR:u.PROTOCOL_ERROR};t.error=O;var S={toNumber:o.toNumber,toString:o.toString,inSafeRange:o.inSafeRange};t.integer=S;var T={isPoint:p.isPoint};t.spatial=T;var C={isDuration:y.isDuration,isLocalTime:y.isLocalTime,isTime:y.isTime,isDate:y.isDate,isLocalDateTime:y.isLocalDateTime,isDateTime:y.isDateTime};t.temporal=C;var R={driver:g,int:o.int,isInt:o.isInt,isPoint:p.isPoint,isDuration:y.isDuration,isLocalTime:y.isLocalTime,isTime:y.isTime,isDate:y.isDate,isLocalDateTime:y.isLocalDateTime,isDateTime:y.isDateTime,integer:S,Neo4jError:u.Neo4jError,auth:b,logging:E,types:w,session:I,error:O,spatial:T,temporal:C};t.default=R}).call(this,n(85))},156:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.EMPTY_CONNECTION_HOLDER=t.default=void 0;var i=r(n(31)),o=r(n(32)),a=r(n(27)),u=r(n(6)),s=r(n(8)),c=n(22),l=n(40),f=n(62),h=r(n(90));function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,a.default)(e);if(t){var i=(0,a.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,o.default)(this,n)}}var v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.mode,r=void 0===n?f.ACCESS_MODE_WRITE:n,i=t.database,o=void 0===i?"":i,a=t.bookmark,s=t.connectionProvider;(0,u.default)(this,e),this._mode=r,this._database=o?(0,l.assertString)(o,"database"):"",this._bookmark=a||h.default.empty(),this._connectionProvider=s,this._referenceCount=0,this._connectionPromise=Promise.resolve(null)}return(0,s.default)(e,[{key:"mode",value:function(){return this._mode}},{key:"database",value:function(){return this._database}},{key:"initializeConnection",value:function(){return 0!==this._referenceCount?(this._referenceCount++,!1):(this._connectionPromise=this._connectionProvider.acquireConnection({accessMode:this._mode,database:this._database,bookmark:this._bookmark}),this._referenceCount++,!0)}},{key:"getConnection",value:function(){return this._connectionPromise}},{key:"releaseConnection",value:function(){return 0===this._referenceCount?this._connectionPromise:(this._referenceCount--,0===this._referenceCount?this._releaseConnection():this._connectionPromise)}},{key:"close",value:function(){return 0===this._referenceCount?this._connectionPromise:(this._referenceCount=0,this._releaseConnection())}},{key:"_releaseConnection",value:function(){return this._connectionPromise=this._connectionPromise.then((function(e){return e?e.resetAndFlush().catch(_).then((function(){return e._release()})):Promise.resolve()})).catch(_),this._connectionPromise}}]),e}();function _(e){}t.default=v;var p=new(function(e){(0,i.default)(n,e);var t=d(n);function n(){return(0,u.default)(this,n),t.apply(this,arguments)}return(0,s.default)(n,[{key:"initializeConnection",value:function(){return!0}},{key:"getConnection",value:function(){return Promise.reject((0,c.newError)("This connection holder does not serve connections"))}},{key:"releaseConnection",value:function(){return Promise.resolve()}},{key:"close",value:function(){return Promise.resolve()}}]),n}(v));t.EMPTY_CONNECTION_HOLDER=p},157:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=(n(66),r(n(158)),function(){function e(t){(0,i.default)(this,e),this._errorHandler=t}return(0,o.default)(e,[{key:"isOpen",value:function(){throw new Error("not implemented")}},{key:"protocol",value:function(){throw new Error("not implemented")}},{key:"connect",value:function(e,t){throw new Error("not implemented")}},{key:"write",value:function(e,t,n){throw new Error("not implemented")}},{key:"resetAndFlush",value:function(){throw new Error("not implemented")}},{key:"close",value:function(){throw new Error("not implemented")}},{key:"handleAndTransformError",value:function(e,t){return this._errorHandler?this._errorHandler.handleAndTransformError(e,t):e}},{key:"id",get:function(){throw new Error("not implemented")}},{key:"databaseId",get:function(){throw new Error("not implemented")},set:function(e){throw new Error("not implemented")}},{key:"address",get:function(){throw new Error("not implemented")}},{key:"version",get:function(){throw new Error("not implemented")},set:function(e){throw new Error("not implemented")}},{key:"server",get:function(){throw new Error("not implemented")}}]),e}());t.default=a},158:function(e,t,n){"use strict";var r=n(61),i=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(6)),a=i(n(8)),u=n(249),s=i(n(90)),c=(n(250),i(n(157)),n(62)),l=r(n(251)),f=i(n(113)),h=n(66),d=i(n(134)),v=function(){function e(t,n,r){(0,o.default)(this,e),this._connection=t,this._packer=this._createPacker(n),this._unpacker=this._createUnpacker(r)}return(0,a.default)(e,[{key:"packer",value:function(){return this._packer}},{key:"unpacker",value:function(){return this._unpacker}},{key:"transformMetadata",value:function(e){return e}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userAgent,n=e.authToken,r=e.onError,i=e.onComplete,o=new h.LoginObserver({connection:this._connection,afterError:r,afterComplete:i});return this._connection.write(f.default.init(t,n),o,!0),o}},{key:"prepareToClose",value:function(){}},{key:"beginTransaction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.bookmark,n=e.txConfig,r=e.database,i=e.mode,o=e.beforeError,a=e.afterError,u=e.beforeComplete,s=e.afterComplete;return this.run("BEGIN",t?t.asBeginTransactionParameters():{},{bookmark:t,txConfig:n,database:r,mode:i,beforeError:o,afterError:a,beforeComplete:u,afterComplete:s,flush:!1})}},{key:"commitTransaction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.beforeError,n=e.afterError,r=e.beforeComplete,i=e.afterComplete;return this.run("COMMIT",{},{bookmark:s.default.empty(),txConfig:d.default.empty(),mode:c.ACCESS_MODE_WRITE,beforeError:t,afterError:n,beforeComplete:r,afterComplete:i})}},{key:"rollbackTransaction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.beforeError,n=e.afterError,r=e.beforeComplete,i=e.afterComplete;return this.run("ROLLBACK",{},{bookmark:s.default.empty(),txConfig:d.default.empty(),mode:c.ACCESS_MODE_WRITE,beforeError:t,afterError:n,beforeComplete:r,afterComplete:i})}},{key:"run",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=(n.bookmark,n.txConfig),i=n.database,o=(n.mode,n.beforeKeys),a=n.afterKeys,s=n.beforeError,c=n.afterError,l=n.beforeComplete,d=n.afterComplete,v=n.flush,_=void 0===v||v,p=new h.ResultStreamObserver({connection:this._connection,beforeKeys:o,afterKeys:a,beforeError:s,afterError:c,beforeComplete:l,afterComplete:d});return(0,u.assertTxConfigIsEmpty)(r,this._connection,p),(0,u.assertDatabaseIsEmpty)(i,this._connection,p),this._connection.write(f.default.run(e,t),p,!1),this._connection.write(f.default.pullAll(),p,_),p}},{key:"reset",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.onError,n=e.onComplete,r=new h.ResetObserver({connection:this._connection,onError:t,onComplete:n});return this._connection.write(f.default.reset(),r,!0),r}},{key:"_createPacker",value:function(e){return new l.Packer(e)}},{key:"_createUnpacker",value:function(e){return new l.Unpacker(e)}},{key:"version",get:function(){return c.BOLT_PROTOCOL_V1}}]),e}();t.default=v},159:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(86)),o=r(n(91)),a=r(n(6)),u=r(n(8)),s=n(66),c=r(n(199)),l=r(n(259)),f=n(22),h=n(40),d=r(n(156)),v=r(n(114)),_=n(62),p=r(n(345)),y=r(n(90)),m=r(n(134));var g=function(){function e(t){var n=t.mode,r=t.connectionProvider,i=t.bookmark,o=t.database,u=t.config,s=t.reactive,c=t.fetchSize;(0,a.default)(this,e),this._mode=n,this._database=o,this._reactive=s,this._fetchSize=c,this._readConnectionHolder=new d.default({mode:_.ACCESS_MODE_READ,database:o,bookmark:i,connectionProvider:r}),this._writeConnectionHolder=new d.default({mode:_.ACCESS_MODE_WRITE,database:o,bookmark:i,connectionProvider:r}),this._open=!0,this._hasTx=!1,this._lastBookmark=i,this._transactionExecutor=function(e){var t=e&&e.maxTransactionRetryTime?e.maxTransactionRetryTime:null;return new p.default(t)}(u),this._onComplete=this._onCompleteCallback.bind(this)}var t;return(0,u.default)(e,[{key:"run",value:function(e,t,n){var r=this,i=(0,h.validateQueryAndParameters)(e,t),o=i.validatedQuery,a=i.params,u=n?new m.default(n):m.default.empty();return this._run(o,a,(function(e){return r._assertSessionIsOpen(),e.protocol().run(o,a,{bookmark:r._lastBookmark,txConfig:u,mode:r._mode,database:r._database,afterComplete:r._onComplete,reactive:r._reactive,fetchSize:r._fetchSize})}))}},{key:"_run",value:function(e,t,n){var r,i=this._connectionHolderWithMode(this._mode);return r=this._open?!this._hasTx&&i.initializeConnection()?i.getConnection().then((function(e){return n(e)})).catch((function(e){return Promise.resolve(new s.FailedObserver({error:e}))})):Promise.resolve(new s.FailedObserver({error:(0,f.newError)("Queries cannot be run directly on a session with an open transaction; either run from within the transaction or use a different session.")})):Promise.resolve(new s.FailedObserver({error:(0,f.newError)("Cannot run query in a closed session.")})),new c.default(r,e,t,i)}},{key:"beginTransaction",value:function(e){var t=e,n=m.default.empty();return t&&(n=new m.default(t)),this._beginTransaction(this._mode,n)}},{key:"_beginTransaction",value:function(e,t){if(!this._open)throw(0,f.newError)("Cannot begin a transaction on a closed session.");if(this._hasTx)throw(0,f.newError)("You cannot begin a transaction on a session with an open transaction; either run from within the transaction or use a different session.");var n=v.default._validateSessionMode(e),r=this._connectionHolderWithMode(n);r.initializeConnection(),this._hasTx=!0;var i=new l.default({connectionHolder:r,onClose:this._transactionClosed.bind(this),onBookmark:this._updateBookmark.bind(this),onConnection:this._assertSessionIsOpen.bind(this),reactive:this._reactive,fetchSize:this._fetchSize});return i._begin(this._lastBookmark,t),i}},{key:"_assertSessionIsOpen",value:function(){if(!this._open)throw(0,f.newError)("You cannot run more transactions on a closed session.")}},{key:"_transactionClosed",value:function(){this._hasTx=!1}},{key:"lastBookmark",value:function(){return this._lastBookmark.values()}},{key:"readTransaction",value:function(e,t){var n=new m.default(t);return this._runTransaction(_.ACCESS_MODE_READ,n,e)}},{key:"writeTransaction",value:function(e,t){var n=new m.default(t);return this._runTransaction(_.ACCESS_MODE_WRITE,n,e)}},{key:"_runTransaction",value:function(e,t,n){var r=this;return this._transactionExecutor.execute((function(){return r._beginTransaction(e,t)}),n)}},{key:"_updateBookmark",value:function(e){e&&!e.isEmpty()&&(this._lastBookmark=e)}},{key:"close",value:(t=(0,o.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._open){e.next=7;break}return this._open=!1,this._transactionExecutor.close(),e.next=5,this._readConnectionHolder.close();case 5:return e.next=7,this._writeConnectionHolder.close();case 7:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"_connectionHolderWithMode",value:function(e){if(e===_.ACCESS_MODE_READ)return this._readConnectionHolder;if(e===_.ACCESS_MODE_WRITE)return this._writeConnectionHolder;throw(0,f.newError)("Unknown access mode: "+e)}},{key:"_onCompleteCallback",value:function(e){this._updateBookmark(new y.default(e.bookmark))}}]),e}();t.default=g},199:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=r(n(200)),u=n(156),s=(n(66),function(e){console.log("Uncaught error when processing result: "+e)}),c=function(e){};var l=function(){function e(t,n,r,o){(0,i.default)(this,e),this._stack=function(){var e=new Error("");if(e.stack)return e.stack.replace(/^Error(\n\r)*/,"");return null}(),this._streamObserverPromise=t,this._p=null,this._query=n,this._parameters=r||{},this._connectionHolder=o||u.EMPTY_CONNECTION_HOLDER}return(0,o.default)(e,[{key:"keys",value:function(){var e=this;return new Promise((function(t,n){e._streamObserverPromise.then((function(e){return e.subscribe({onKeys:function(e){return t(e)},onError:function(e){return n(e)}})}))}))}},{key:"summary",value:function(){var e=this;return new Promise((function(t,n){e._streamObserverPromise.then((function(e){e.cancel(),e.subscribe({onCompleted:function(e){return t(e)},onError:function(e){return n(e)}})}))}))}},{key:"_getOrCreatePromise",value:function(){var e=this;return this._p||(this._p=new Promise((function(t,n){var r=[],i={onNext:function(e){r.push(e)},onCompleted:function(e){t({records:r,summary:e})},onError:function(e){n(e)}};e.subscribe(i)}))),this._p}},{key:"then",value:function(e,t){return this._getOrCreatePromise().then(e,t)}},{key:"catch",value:function(e){return this._getOrCreatePromise().catch(e)}},{key:"subscribe",value:function(e){var t=this,n=e.onCompleted||c;e.onCompleted=function(r){var i=t._connectionHolder,o=t._query,u=t._parameters;function s(t){i.releaseConnection().then((function(){n.call(e,new a.default(o,u,r,t))}))}i.getConnection().then((function(e){s(e?e.protocol().version:void 0)}),(function(e){s()}))};var r=e.onError||s;e.onError=function(n){t._connectionHolder.releaseConnection().then((function(){!function(e,t){t&&(e.stack=e.toString()+"\n"+t)}(n,t._stack),r.call(e,n)}))},this._streamObserverPromise.then((function(t){return t.subscribe(e)}))}},{key:"_cancel",value:function(){this._streamObserverPromise.then((function(e){return e.cancel()}))}}]),e}();t.default=l},200:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.queryType=void 0;var i=r(n(6)),o=r(n(8)),a=n(51),u=function(){function e(t,n,r,o){(0,i.default)(this,e),this.query={text:t,parameters:n},this.queryType=r.type,this.counters=new l(r.stats||{}),this.updateStatistics=this.counters,this.plan=!(!r.plan&&!r.profile)&&new s(r.plan||r.profile),this.profile=!!r.profile&&new c(r.profile),this.notifications=this._buildNotifications(r.notifications),this.server=new h(r.server,o),this.resultConsumedAfter=r.result_consumed_after,this.resultAvailableAfter=r.result_available_after,this.database={name:r.db||null}}return(0,o.default)(e,[{key:"_buildNotifications",value:function(e){return e?e.map((function(e){return new f(e)})):[]}},{key:"hasPlan",value:function(){return this.plan instanceof s}},{key:"hasProfile",value:function(){return this.profile instanceof c}}]),e}(),s=function e(t){(0,i.default)(this,e),this.operatorType=t.operatorType,this.identifiers=t.identifiers,this.arguments=t.args,this.children=t.children?t.children.map((function(t){return new e(t)})):[]},c=function(){function e(t){(0,i.default)(this,e),this.operatorType=t.operatorType,this.identifiers=t.identifiers,this.arguments=t.args,this.dbHits=v("dbHits",t),this.rows=v("rows",t),this.pageCacheMisses=v("pageCacheMisses",t),this.pageCacheHits=v("pageCacheHits",t),this.pageCacheHitRatio=v("pageCacheHitRatio",t),this.time=v("time",t),this.children=t.children?t.children.map((function(t){return new e(t)})):[]}return(0,o.default)(e,[{key:"hasPageCacheStats",value:function(){return this.pageCacheMisses>0||this.pageCacheHits>0||this.pageCacheHitRatio>0}}]),e}(),l=function(){function e(t){var n=this;(0,i.default)(this,e),this._stats={nodesCreated:0,nodesDeleted:0,relationshipsCreated:0,relationshipsDeleted:0,propertiesSet:0,labelsAdded:0,labelsRemoved:0,indexesAdded:0,indexesRemoved:0,constraintsAdded:0,constraintsRemoved:0},this._systemUpdates=0,Object.keys(t).forEach((function(e){var r=e.replace(/(-\w)/g,(function(e){return e[1].toUpperCase()}));r in n._stats?n._stats[r]=d(t[e]):"systemUpdates"===r&&(n._systemUpdates=d(t[e]))})),this._stats=Object.freeze(this._stats)}return(0,o.default)(e,[{key:"containsUpdates",value:function(){var e=this;return Object.keys(this._stats).reduce((function(t,n){return t+e._stats[n]}),0)>0}},{key:"updates",value:function(){return this._stats}},{key:"containsSystemUpdates",value:function(){return this._systemUpdates>0}},{key:"systemUpdates",value:function(){return this._systemUpdates}}]),e}(),f=function(){function e(t){(0,i.default)(this,e),this.code=t.code,this.title=t.title,this.description=t.description,this.severity=t.severity,this.position=e._constructPosition(t.position)}return(0,o.default)(e,null,[{key:"_constructPosition",value:function(e){return e?{offset:d(e.offset),line:d(e.line),column:d(e.column)}:{}}}]),e}(),h=function e(t,n){(0,i.default)(this,e),t&&(this.address=t.address,this.version=t.version),this.protocolVersion=n};function d(e){return(0,a.isInt)(e)?e.toInt():e}function v(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;if(e in t){var r=t[e];return(0,a.isInt)(r)?r.toInt():r}return n}t.queryType={READ_ONLY:"r",READ_WRITE:"rw",WRITE_ONLY:"w",SCHEMA_WRITE:"s"};var _=u;t.default=_},201:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(86)),o=r(n(246)),a=r(n(6)),u=r(n(8)),s=n(22);function c(e){if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=function(e,t){if(!e)return;if("string"==typeof e)return l(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);"Object"===n&&e.constructor&&(n=e.constructor.name);if("Map"===n||"Set"===n)return Array.from(e);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return l(e,t)}(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var r,i,o=!0,a=!1;return{s:function(){r=e[Symbol.iterator]()},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function l(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function f(e){var t={};return e.forEach((function(e,n){t[e]=n})),t}var h=function(){function e(t,n){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;(0,a.default)(this,e),this.keys=t,this.length=t.length,this._fields=n,this._fieldLookup=r||f(t)}return(0,u.default)(e,[{key:"forEach",value:function(e){var t,n=c(this.entries());try{for(n.s();!(t=n.n()).done;){var r=(0,o.default)(t.value,2),i=r[0];e(r[1],i,this)}}catch(e){n.e(e)}finally{n.f()}}},{key:"map",value:function(e){var t,n=[],r=c(this.entries());try{for(r.s();!(t=r.n()).done;){var i=(0,o.default)(t.value,2),a=i[0],u=i[1];n.push(e(u,a,this))}}catch(e){r.e(e)}finally{r.f()}return n}},{key:"entries",value:i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<this.keys.length)){e.next=7;break}return e.next=4,[this.keys[t],this._fields[t]];case 4:t++,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:"values",value:i.default.mark((function e(){var t;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=0;case 1:if(!(t<this.keys.length)){e.next=7;break}return e.next=4,this._fields[t];case 4:t++,e.next=1;break;case 7:case"end":return e.stop()}}),e,this)}))},{key:Symbol.iterator,value:i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.delegateYield(this.values(),"t0",1);case 1:case"end":return e.stop()}}),e,this)}))},{key:"toObject",value:function(){var e,t={},n=c(this.entries());try{for(n.s();!(e=n.n()).done;){var r=(0,o.default)(e.value,2),i=r[0],a=r[1];t[i]=a}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"get",value:function(e){var t;if("number"!=typeof e){if(void 0===(t=this._fieldLookup[e]))throw(0,s.newError)("This record has no field with key '"+e+"', available key are: ["+this.keys+"].")}else t=e;if(t>this._fields.length-1||t<0)throw(0,s.newError)("This record has no field with index '"+t+"'. Remember that indexes start at `0`, and make sure your query returns records in the shape you meant it to.");return this._fields[t]}},{key:"has",value:function(e){return"number"==typeof e?e>=0&&e<this._fields.length:void 0!==this._fieldLookup[e]}}]),e}();t.default=h},202:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(31)),o=r(n(32)),a=r(n(27)),u=r(n(6)),s=r(n(8));function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,a.default)(e);if(t){var i=(0,a.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,o.default)(this,n)}}var l=function(){function e(t){(0,u.default)(this,e),this.position=0,this.length=t}return(0,s.default)(e,[{key:"getUInt8",value:function(e){throw new Error("Not implemented")}},{key:"getInt8",value:function(e){throw new Error("Not implemented")}},{key:"getFloat64",value:function(e){throw new Error("Not implemented")}},{key:"putUInt8",value:function(e,t){throw new Error("Not implemented")}},{key:"putInt8",value:function(e,t){throw new Error("Not implemented")}},{key:"putFloat64",value:function(e,t){throw new Error("Not implemented")}},{key:"getInt16",value:function(e){return this.getInt8(e)<<8|this.getUInt8(e+1)}},{key:"getUInt16",value:function(e){return this.getUInt8(e)<<8|this.getUInt8(e+1)}},{key:"getInt32",value:function(e){return this.getInt8(e)<<24|this.getUInt8(e+1)<<16|this.getUInt8(e+2)<<8|this.getUInt8(e+3)}},{key:"getUInt32",value:function(e){return this.getUInt8(e)<<24|this.getUInt8(e+1)<<16|this.getUInt8(e+2)<<8|this.getUInt8(e+3)}},{key:"getInt64",value:function(e){return this.getInt8(e)<<56|this.getUInt8(e+1)<<48|this.getUInt8(e+2)<<40|this.getUInt8(e+3)<<32|this.getUInt8(e+4)<<24|this.getUInt8(e+5)<<16|this.getUInt8(e+6)<<8|this.getUInt8(e+7)}},{key:"getSlice",value:function(e,t){return new f(e,t,this)}},{key:"putInt16",value:function(e,t){this.putInt8(e,t>>8),this.putUInt8(e+1,255&t)}},{key:"putUInt16",value:function(e,t){this.putUInt8(e,t>>8&255),this.putUInt8(e+1,255&t)}},{key:"putInt32",value:function(e,t){this.putInt8(e,t>>24),this.putUInt8(e+1,t>>16&255),this.putUInt8(e+2,t>>8&255),this.putUInt8(e+3,255&t)}},{key:"putUInt32",value:function(e,t){this.putUInt8(e,t>>24&255),this.putUInt8(e+1,t>>16&255),this.putUInt8(e+2,t>>8&255),this.putUInt8(e+3,255&t)}},{key:"putInt64",value:function(e,t){this.putInt8(e,t>>48),this.putUInt8(e+1,t>>42&255),this.putUInt8(e+2,t>>36&255),this.putUInt8(e+3,t>>30&255),this.putUInt8(e+4,t>>24&255),this.putUInt8(e+5,t>>16&255),this.putUInt8(e+6,t>>8&255),this.putUInt8(e+7,255&t)}},{key:"putBytes",value:function(e,t){for(var n=0,r=t.remaining();n<r;n++)this.putUInt8(e+n,t.readUInt8())}},{key:"readUInt8",value:function(){return this.getUInt8(this._updatePos(1))}},{key:"readInt8",value:function(){return this.getInt8(this._updatePos(1))}},{key:"readUInt16",value:function(){return this.getUInt16(this._updatePos(2))}},{key:"readUInt32",value:function(){return this.getUInt32(this._updatePos(4))}},{key:"readInt16",value:function(){return this.getInt16(this._updatePos(2))}},{key:"readInt32",value:function(){return this.getInt32(this._updatePos(4))}},{key:"readInt64",value:function(){return this.getInt32(this._updatePos(8))}},{key:"readFloat64",value:function(){return this.getFloat64(this._updatePos(8))}},{key:"writeUInt8",value:function(e){this.putUInt8(this._updatePos(1),e)}},{key:"writeInt8",value:function(e){this.putInt8(this._updatePos(1),e)}},{key:"writeInt16",value:function(e){this.putInt16(this._updatePos(2),e)}},{key:"writeInt32",value:function(e){this.putInt32(this._updatePos(4),e)}},{key:"writeUInt32",value:function(e){this.putUInt32(this._updatePos(4),e)}},{key:"writeInt64",value:function(e){this.putInt64(this._updatePos(8),e)}},{key:"writeFloat64",value:function(e){this.putFloat64(this._updatePos(8),e)}},{key:"writeBytes",value:function(e){this.putBytes(this._updatePos(e.remaining()),e)}},{key:"readSlice",value:function(e){return this.getSlice(this._updatePos(e),e)}},{key:"_updatePos",value:function(e){var t=this.position;return this.position+=e,t}},{key:"remaining",value:function(){return this.length-this.position}},{key:"hasRemaining",value:function(){return this.remaining()>0}},{key:"reset",value:function(){this.position=0}},{key:"toString",value:function(){return this.constructor.name+"( position="+this.position+" )\n  "+this.toHex()}},{key:"toHex",value:function(){for(var e="",t=0;t<this.length;t++){var n=this.getUInt8(t).toString(16);1===n.length&&(n="0"+n),e+=n,t!==this.length-1&&(e+=" ")}return e}}]),e}();t.default=l;var f=function(e){(0,i.default)(n,e);var t=c(n);function n(e,r,i){var o;return(0,u.default)(this,n),(o=t.call(this,r))._start=e,o._inner=i,o}return(0,s.default)(n,[{key:"putUInt8",value:function(e,t){this._inner.putUInt8(this._start+e,t)}},{key:"getUInt8",value:function(e){return this._inner.getUInt8(this._start+e)}},{key:"putInt8",value:function(e,t){this._inner.putInt8(this._start+e,t)}},{key:"putFloat64",value:function(e,t){this._inner.putFloat64(this._start+e,t)}},{key:"getInt8",value:function(e){return this._inner.getInt8(this._start+e)}},{key:"getFloat64",value:function(e){return this._inner.getFloat64(this._start+e)}}]),n}(l)},203:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=r(n(31)),u=r(n(32)),s=r(n(27));function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}var l=function(e){(0,a.default)(n,e);var t=c(n);function n(e){var r;(0,i.default)(this,n);var o=e instanceof ArrayBuffer?e:new ArrayBuffer(e);return(r=t.call(this,o.byteLength))._buffer=o,r._view=new DataView(r._buffer),r}return(0,o.default)(n,[{key:"putUInt8",value:function(e,t){this._view.setUint8(e,t)}},{key:"getUInt8",value:function(e){return this._view.getUint8(e)}},{key:"putInt8",value:function(e,t){this._view.setInt8(e,t)}},{key:"getInt8",value:function(e){return this._view.getInt8(e)}},{key:"getFloat64",value:function(e){return this._view.getFloat64(e)}},{key:"putFloat64",value:function(e,t){this._view.setFloat64(e,t)}},{key:"getSlice",value:function(e,t){if(this._buffer.slice)return new n(this._buffer.slice(e,e+t));for(var r=new n(t),i=0;i<t;i++)r.putUInt8(i,this.getUInt8(i+e));return r}},{key:"readView",value:function(e){return new DataView(this._buffer,this._updatePos(e),e)}}]),n}(r(n(202)).default);t.default=l},204:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=(r(n(90)),function(){function e(){(0,i.default)(this,e)}return(0,o.default)(e,[{key:"acquireConnection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.accessMode,e.database,e.bookmarks;throw new Error("not implemented")}},{key:"supportsMultiDb",value:function(){throw new Error("not implemented")}},{key:"supportsTransactionConfig",value:function(){throw new Error("not implemented")}},{key:"close",value:function(){throw new Error("not implemented")}}]),e}());t.default=a},205:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(86)),o=r(n(91)),a=r(n(6)),u=r(n(8)),s=r(n(155)),c=r(n(31)),l=r(n(32)),f=r(n(27)),h=n(112),d=n(250),v=n(22),_=r(n(339)),p=r(n(340)),y=r(n(157));r(n(158)),n(66);function m(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,l.default)(this,n)}}function g(){}var b={onNext:g,onCompleted:g,onError:g},k=0,E=function(e){(0,c.default)(r,e);var t,n=m(r);function r(e,t,i,o){var u,c=arguments.length>4&&void 0!==arguments[4]&&arguments[4],l=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;return(0,a.default)(this,r),(u=n.call(this,t))._id=k++,u._address=i,u._server={address:i.asHostPort()},u.creationTimestamp=Date.now(),u._disableLosslessIntegers=c,u._pendingObservers=[],u._currentObserver=void 0,u._ch=e,u._dechunker=new d.Dechunker,u._chunker=new d.Chunker(e),u._log=o,u._serversideRouting=l,u._dbConnectionId=null,u._protocol=null,u._currentFailure=null,u._isBroken=!1,u._log.isDebugEnabled()&&u._log.debug("".concat((0,s.default)(u)," created towards ").concat(i)),u}return(0,u.default)(r,[{key:"connect",value:function(e,t){var n=this;return this._negotiateProtocol().then((function(){return n._initialize(e,t)}))}},{key:"_negotiateProtocol",value:function(){var e=this,t=new p.default(this,this._ch,this._chunker,this._disableLosslessIntegers,this._log,this._serversideRouting);return new Promise((function(n,r){var i=function(t){e._handleFatalError(t),r(t)};e._ch.onerror=i.bind(e),e._ch._error&&i(e._ch._error),e._ch.onmessage=function(i){try{e._protocol=t.createNegotiatedProtocol(i),e._ch.onerror=e._handleFatalError.bind(e),e._ch.onmessage=function(t){return e._dechunker.write(t)},e._dechunker.onmessage=function(t){e._handleMessage(e._protocol.unpacker().unpack(t))},i.hasRemaining()&&e._dechunker.write(i.readSlice(i.remaining())),n(e)}catch(t){e._handleFatalError(t),r(t)}},t.writeHandshakeRequest()}))}},{key:"_initialize",value:function(e,t){var n=this,r=this;return new Promise((function(i,o){n._protocol.initialize({userAgent:e,authToken:t,onError:function(e){return o(e)},onComplete:function(){return i(r)}})}))}},{key:"protocol",value:function(){return this._protocol}},{key:"write",value:function(e,t,n){var r=this;this._queueObserver(t)&&(this._log.isDebugEnabled()&&this._log.debug("".concat(this," C: ").concat(e)),this._protocol.packer().packStruct(e.signature,e.fields.map((function(e){return r._packable(e)}))),this._chunker.messageBoundary(),n&&this._chunker.flush())}},{key:"_handleFatalError",value:function(e){for(this._isBroken=!0,this._error=this.handleAndTransformError(e,this._address),this._log.isErrorEnabled()&&this._log.error("".concat(this," experienced a fatal error ").concat(JSON.stringify(this._error))),this._currentObserver&&this._currentObserver.onError&&this._currentObserver.onError(this._error);this._pendingObservers.length>0;){var t=this._pendingObservers.shift();t&&t.onError&&t.onError(this._error)}}},{key:"_handleMessage",value:function(e){if(!this._isBroken){var t=e.fields[0];switch(e.signature){case 113:this._log.isDebugEnabled()&&this._log.debug("".concat(this," S: RECORD ").concat(JSON.stringify(e))),this._currentObserver.onNext(t);break;case 112:this._log.isDebugEnabled()&&this._log.debug("".concat(this," S: SUCCESS ").concat(JSON.stringify(e)));try{var n=this._protocol.transformMetadata(t);this._currentObserver.onCompleted(n)}finally{this._updateCurrentObserver()}break;case 127:this._log.isDebugEnabled()&&this._log.debug("".concat(this," S: FAILURE ").concat(JSON.stringify(e)));try{var r=(0,v.newError)(t.message,t.code);this._currentFailure=this.handleAndTransformError(r,this._address),this._currentObserver.onError(this._currentFailure)}finally{this._updateCurrentObserver(),this._resetOnFailure()}break;case 126:this._log.isDebugEnabled()&&this._log.debug("".concat(this," S: IGNORED ").concat(JSON.stringify(e)));try{this._currentFailure&&this._currentObserver.onError?this._currentObserver.onError(this._currentFailure):this._currentObserver.onError&&this._currentObserver.onError((0,v.newError)("Ignored either because of an error or RESET"))}finally{this._updateCurrentObserver()}break;default:this._handleFatalError((0,v.newError)("Unknown Bolt protocol message: "+e))}}}},{key:"resetAndFlush",value:function(){var e=this;return new Promise((function(t,n){e._protocol.reset({onError:function(t){if(e._isBroken)n(t);else{var r=e._handleProtocolError("Received FAILURE as a response for RESET: "+t);n(r)}},onComplete:function(){t()}})}))}},{key:"_resetOnFailure",value:function(){var e=this;this._protocol.reset({onError:function(){e._currentFailure=null},onComplete:function(){e._currentFailure=null}})}},{key:"_queueObserver",value:function(e){return this._isBroken?(e&&e.onError&&e.onError(this._error),!1):((e=e||b).onCompleted=e.onCompleted||g,e.onError=e.onError||g,e.onNext=e.onNext||g,void 0===this._currentObserver?this._currentObserver=e:this._pendingObservers.push(e),!0)}},{key:"_updateCurrentObserver",value:function(){this._currentObserver=this._pendingObservers.shift()}},{key:"isOpen",value:function(){return!this._isBroken&&this._ch._open}},{key:"close",value:(t=(0,o.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return this._log.isDebugEnabled()&&this._log.debug("".concat(this," closing")),this._protocol&&this.isOpen()&&this._protocol.prepareToClose(),e.next=4,this._ch.close();case 4:this._log.isDebugEnabled()&&this._log.debug("".concat(this," closed"));case 5:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})},{key:"toString",value:function(){return"Connection [".concat(this.id,"][").concat(this.databaseId||"","]")}},{key:"_packable",value:function(e){return this._protocol.packer().packable(e)}},{key:"_handleProtocolError",value:function(e){this._currentFailure=null,this._updateCurrentObserver();var t=(0,v.newError)(e,v.PROTOCOL_ERROR);return this._handleFatalError(t),t}},{key:"id",get:function(){return this._id}},{key:"databaseId",get:function(){return this._dbConnectionId},set:function(e){this._dbConnectionId=e}},{key:"address",get:function(){return this._address}},{key:"version",get:function(){return this._server.version},set:function(e){this._server.version=e}},{key:"server",get:function(){return this._server}}],[{key:"create",value:function(e,t,n,i){var o=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,a=new _.default(e,t,n.errorCode());return new r(new h.Channel(a),n,e,i,t.disableLosslessIntegers,o)}}]),r}(y.default);t.default=E},206:function(e,t,n){"use strict";var r=n(61),i=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.isDuration=function(e){return m(e,"__isDuration__")},t.isLocalTime=function(e){return m(e,"__isLocalTime__")},t.isTime=function(e){return m(e,"__isTime__")},t.isDate=function(e){return m(e,"__isDate__")},t.isLocalDateTime=function(e){return m(e,"__isLocalDateTime__")},t.isDateTime=function(e){return m(e,"__isDateTime__")},t.DateTime=t.LocalDateTime=t.Date=t.Time=t.LocalTime=t.Duration=void 0;var o=i(n(246)),a=i(n(6)),u=i(n(8)),s=r(n(255)),c=n(40),l=n(22),f={value:!0,enumerable:!1,configurable:!1,writable:!1},h=function(){function e(t,n,r,i){(0,a.default)(this,e),this.months=(0,c.assertNumberOrInteger)(t,"Months"),this.days=(0,c.assertNumberOrInteger)(n,"Days"),(0,c.assertNumberOrInteger)(r,"Seconds"),(0,c.assertNumberOrInteger)(i,"Nanoseconds"),this.seconds=s.normalizeSecondsForDuration(r,i),this.nanoseconds=s.normalizeNanosecondsForDuration(i),Object.freeze(this)}return(0,u.default)(e,[{key:"toString",value:function(){return s.durationToIsoString(this.months,this.days,this.seconds,this.nanoseconds)}}]),e}();t.Duration=h,Object.defineProperty(h.prototype,"__isDuration__",f);var d=function(){function e(t,n,r,i){(0,a.default)(this,e),this.hour=s.assertValidHour(t),this.minute=s.assertValidMinute(n),this.second=s.assertValidSecond(r),this.nanosecond=s.assertValidNanosecond(i),Object.freeze(this)}return(0,u.default)(e,[{key:"toString",value:function(){return s.timeToIsoString(this.hour,this.minute,this.second,this.nanosecond)}}],[{key:"fromStandardDate",value:function(t,n){return b(t,n),new e(t.getHours(),t.getMinutes(),t.getSeconds(),s.totalNanoseconds(t,n))}}]),e}();t.LocalTime=d,Object.defineProperty(d.prototype,"__isLocalTime__",f);var v=function(){function e(t,n,r,i,o){(0,a.default)(this,e),this.hour=s.assertValidHour(t),this.minute=s.assertValidMinute(n),this.second=s.assertValidSecond(r),this.nanosecond=s.assertValidNanosecond(i),this.timeZoneOffsetSeconds=(0,c.assertNumberOrInteger)(o,"Time zone offset in seconds"),Object.freeze(this)}return(0,u.default)(e,[{key:"toString",value:function(){return s.timeToIsoString(this.hour,this.minute,this.second,this.nanosecond)+s.timeZoneOffsetToIsoString(this.timeZoneOffsetSeconds)}}],[{key:"fromStandardDate",value:function(t,n){return b(t,n),new e(t.getHours(),t.getMinutes(),t.getSeconds(),s.totalNanoseconds(t,n),s.timeZoneOffsetInSeconds(t))}}]),e}();t.Time=v,Object.defineProperty(v.prototype,"__isTime__",f);var _=function(){function e(t,n,r){(0,a.default)(this,e),this.year=s.assertValidYear(t),this.month=s.assertValidMonth(n),this.day=s.assertValidDay(r),Object.freeze(this)}return(0,u.default)(e,[{key:"toString",value:function(){return s.dateToIsoString(this.year,this.month,this.day)}}],[{key:"fromStandardDate",value:function(t){return b(t,null),new e(t.getFullYear(),t.getMonth()+1,t.getDate())}}]),e}();t.Date=_,Object.defineProperty(_.prototype,"__isDate__",f);var p=function(){function e(t,n,r,i,o,u,c){(0,a.default)(this,e),this.year=s.assertValidYear(t),this.month=s.assertValidMonth(n),this.day=s.assertValidDay(r),this.hour=s.assertValidHour(i),this.minute=s.assertValidMinute(o),this.second=s.assertValidSecond(u),this.nanosecond=s.assertValidNanosecond(c),Object.freeze(this)}return(0,u.default)(e,[{key:"toString",value:function(){return g(this.year,this.month,this.day,this.hour,this.minute,this.second,this.nanosecond)}}],[{key:"fromStandardDate",value:function(t,n){return b(t,n),new e(t.getFullYear(),t.getMonth()+1,t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),s.totalNanoseconds(t,n))}}]),e}();t.LocalDateTime=p,Object.defineProperty(p.prototype,"__isLocalDateTime__",f);var y=function(){function e(t,n,r,i,u,f,h,d,v){(0,a.default)(this,e),this.year=s.assertValidYear(t),this.month=s.assertValidMonth(n),this.day=s.assertValidDay(r),this.hour=s.assertValidHour(i),this.minute=s.assertValidMinute(u),this.second=s.assertValidSecond(f),this.nanosecond=s.assertValidNanosecond(h);var _=function(e,t){var n=e||0===e,r=t&&""!==t;if(n&&!r)return(0,c.assertNumberOrInteger)(e,"Time zone offset in seconds"),[e,null];if(!n&&r)return(0,c.assertString)(t,"Time zone ID"),[null,t];throw n&&r?(0,l.newError)("Unable to create DateTime with both time zone offset and id. Please specify either of them. Given offset: ".concat(e," and id: ").concat(t)):(0,l.newError)("Unable to create DateTime without either time zone offset or id. Please specify either of them. Given offset: ".concat(e," and id: ").concat(t))}(d,v),p=(0,o.default)(_,2),y=p[0],m=p[1];this.timeZoneOffsetSeconds=y,this.timeZoneId=m,Object.freeze(this)}return(0,u.default)(e,[{key:"toString",value:function(){return g(this.year,this.month,this.day,this.hour,this.minute,this.second,this.nanosecond)+(this.timeZoneId?"[".concat(this.timeZoneId,"]"):s.timeZoneOffsetToIsoString(this.timeZoneOffsetSeconds))}}],[{key:"fromStandardDate",value:function(t,n){return b(t,n),new e(t.getFullYear(),t.getMonth()+1,t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),s.totalNanoseconds(t,n),s.timeZoneOffsetInSeconds(t),null)}}]),e}();function m(e,t){return!0===(e&&e[t])}function g(e,t,n,r,i,o,a){return s.dateToIsoString(e,t,n)+"T"+s.timeToIsoString(r,i,o,a)}function b(e,t){(0,c.assertValidDate)(e,"Standard date"),null!=t&&(0,c.assertNumberOrInteger)(t,"Nanosecond")}t.DateTime=y,Object.defineProperty(y.prototype,"__isDateTime__",f)},207:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.DEFAULT_ACQUISITION_TIMEOUT=t.DEFAULT_MAX_SIZE=t.default=void 0;var i=r(n(6)),o=r(n(8));t.DEFAULT_MAX_SIZE=100;t.DEFAULT_ACQUISITION_TIMEOUT=6e4;var a=function(){function e(t,n){(0,i.default)(this,e),this.maxSize=u(t,100),this.acquisitionTimeout=u(n,6e4)}return(0,o.default)(e,null,[{key:"defaultConfig",value:function(){return new e(100,6e4)}},{key:"fromDriverConfig",value:function(t){return new e(s(t.maxConnectionPoolSize)?t.maxConnectionPoolSize:100,s(t.connectionAcquisitionTimeout)?t.connectionAcquisitionTimeout:6e4)}}]),e}();function u(e,t){return 0===e||e?e:t}function s(e){return 0===e||e}t.default=a},208:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i,o=r(n(31)),a=r(n(32)),u=r(n(27)),s=r(n(6)),c=r(n(8)),l=r(n(243)),f=n(22);function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var i=(0,u.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.default)(this,n)}}var d=(i={},(0,l.default)(i,"error",0),(0,l.default)(i,"warn",1),(0,l.default)(i,"info",2),(0,l.default)(i,"debug",3),i),v=function(){function e(t,n){(0,s.default)(this,e),this._level=t,this._loggerFunction=n}return(0,c.default)(e,[{key:"isErrorEnabled",value:function(){return p(this._level,"error")}},{key:"error",value:function(e){this.isErrorEnabled()&&this._loggerFunction("error",e)}},{key:"isWarnEnabled",value:function(){return p(this._level,"warn")}},{key:"warn",value:function(e){this.isWarnEnabled()&&this._loggerFunction("warn",e)}},{key:"isInfoEnabled",value:function(){return p(this._level,"info")}},{key:"info",value:function(e){this.isInfoEnabled()&&this._loggerFunction("info",e)}},{key:"isDebugEnabled",value:function(){return p(this._level,"debug")}},{key:"debug",value:function(e){this.isDebugEnabled()&&this._loggerFunction("debug",e)}}],[{key:"create",value:function(t){if(t&&t.logging){var n=t.logging;return new e(function(e){if(e&&e.level){var t=e.level,n=d[t];if(!n&&0!==n)throw(0,f.newError)("Illegal logging level: ".concat(t,". Supported levels are: ").concat(Object.keys(d)));return t}return"info"}(n),function(e){if(e&&e.logger){var t=e.logger;if(t&&"function"==typeof t)return t}throw(0,f.newError)("Illegal logger function: ".concat(e.logger))}(n))}return this.noOp()}},{key:"noOp",value:function(){return _}}]),e}(),_=new(function(e){(0,o.default)(n,e);var t=h(n);function n(){return(0,s.default)(this,n),t.call(this,null,null)}return(0,c.default)(n,[{key:"isErrorEnabled",value:function(){return!1}},{key:"error",value:function(e){}},{key:"isWarnEnabled",value:function(){return!1}},{key:"warn",value:function(e){}},{key:"isInfoEnabled",value:function(){return!1}},{key:"info",value:function(e){}},{key:"isDebugEnabled",value:function(){return!1}},{key:"debug",value:function(e){}}]),n}(v));function p(e,t){return d[e]>=d[t]}var y=v;t.default=y},209:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=n(22),u=function(){function e(t,n,r){(0,i.default)(this,e),this._errorCode=t,this._handleUnavailability=n||s,this._handleWriteFailure=r||s}return(0,o.default)(e,[{key:"errorCode",value:function(){return this._errorCode}},{key:"handleAndTransformError",value:function(e,t){return function(e){if(e)return e.code===a.SESSION_EXPIRED||e.code===a.SERVICE_UNAVAILABLE||"Neo.TransientError.General.DatabaseUnavailable"===e.code;return!1}(e)?this._handleUnavailability(e,t):function(e){if(e)return"Neo.ClientError.Cluster.NotALeader"===e.code||"Neo.ClientError.General.ForbiddenOnReadOnlyDatabase"===e.code;return!1}(e)?this._handleWriteFailure(e,t):e}}]),e}();function s(e){return e}t.default=u},210:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=n(40),u=r(n(263)),s=function(){function e(t,n,r,o){(0,i.default)(this,e),this._host=(0,a.assertString)(t,"host"),this._resolved=n?(0,a.assertString)(n,"resolved"):null,this._port=(0,a.assertNumber)(r,"port"),this._hostPort=o,this._stringValue=n?"".concat(o,"(").concat(n,")"):"".concat(o)}return(0,o.default)(e,[{key:"host",value:function(){return this._host}},{key:"resolvedHost",value:function(){return this._resolved?this._resolved:this._host}},{key:"port",value:function(){return this._port}},{key:"resolveWith",value:function(t){return new e(this._host,t,this._port,this._hostPort)}},{key:"asHostPort",value:function(){return this._hostPort}},{key:"asKey",value:function(){return this._hostPort}},{key:"toString",value:function(){return this._stringValue}}],[{key:"fromUrl",value:function(t){var n=u.default.parseDatabaseUrl(t);return new e(n.host,null,n.port,n.hostAndPort)}}]),e}();t.default=s},22:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.newError=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"N/A";return new l(e,t)},t.PROTOCOL_ERROR=t.SESSION_EXPIRED=t.SERVICE_UNAVAILABLE=t.Neo4jError=void 0;var i=r(n(6)),o=r(n(31)),a=r(n(32)),u=r(n(27)),s=r(n(324));function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,u.default)(e);if(t){var i=(0,u.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,a.default)(this,n)}}t.SERVICE_UNAVAILABLE="ServiceUnavailable";t.SESSION_EXPIRED="SessionExpired";t.PROTOCOL_ERROR="ProtocolError";var l=function(e){(0,o.default)(n,e);var t=c(n);function n(e){var r,o=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"N/A";return(0,i.default)(this,n),(r=t.call(this,e)).message=e,r.code=o,r.name="Neo4jError",r}return n}((0,s.default)(Error));t.Neo4jError=l},242:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.isNode=function(e){return u(e,"__isNode__")},t.isRelationship=function(e){return u(e,"__isRelationship__")},t.isUnboundRelationship=function(e){return u(e,UNBOUNT_RELATIONSHIP_IDENTIFIER_PROPERTY)},t.isPath=function(e){return u(e,"__isPath__")},t.isPathSegment=function(e){return u(e,"__isPathSegment__")},t.PathSegment=t.Path=t.UnboundRelationship=t.Relationship=t.Node=void 0;var i=r(n(6)),o=r(n(8)),a={value:!0,enumerable:!1,configurable:!1,writable:!1};function u(e,t){return!0===(e&&e[t])}var s=function(){function e(t,n,r){(0,i.default)(this,e),this.identity=t,this.labels=n,this.properties=r}return(0,o.default)(e,[{key:"toString",value:function(){for(var e="("+this.identity,t=0;t<this.labels.length;t++)e+=":"+this.labels[t];var n=Object.keys(this.properties);if(n.length>0){e+=" {";for(var r=0;r<n.length;r++)r>0&&(e+=","),e+=n[r]+":"+JSON.stringify(this.properties[n[r]]);e+="}"}return e+=")"}}]),e}();t.Node=s,Object.defineProperty(s.prototype,"__isNode__",a);var c=function(){function e(t,n,r,o,a){(0,i.default)(this,e),this.identity=t,this.start=n,this.end=r,this.type=o,this.properties=a}return(0,o.default)(e,[{key:"toString",value:function(){var e="("+this.start+")-[:"+this.type,t=Object.keys(this.properties);if(t.length>0){e+=" {";for(var n=0;n<t.length;n++)n>0&&(e+=","),e+=t[n]+":"+JSON.stringify(this.properties[t[n]]);e+="}"}return e+="]->("+this.end+")"}}]),e}();t.Relationship=c,Object.defineProperty(c.prototype,"__isRelationship__",a);var l=function(){function e(t,n,r){(0,i.default)(this,e),this.identity=t,this.type=n,this.properties=r}return(0,o.default)(e,[{key:"bind",value:function(e,t){return new c(this.identity,e,t,this.type,this.properties)}},{key:"toString",value:function(){var e="-[:"+this.type,t=Object.keys(this.properties);if(t.length>0){e+=" {";for(var n=0;n<t.length;n++)n>0&&(e+=","),e+=t[n]+":"+JSON.stringify(this.properties[t[n]]);e+="}"}return e+="]->"}}]),e}();t.UnboundRelationship=l,Object.defineProperty(l.prototype,"__isUnboundRelationship__",a);var f=function e(t,n,r){(0,i.default)(this,e),this.start=t,this.relationship=n,this.end=r};t.PathSegment=f,Object.defineProperty(f.prototype,"__isPathSegment__",a);var h=function e(t,n,r){(0,i.default)(this,e),this.start=t,this.end=n,this.segments=r,this.length=r.length};t.Path=h,Object.defineProperty(h.prototype,"__isPath__",a)},249:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.assertDatabaseIsEmpty=function(e,t,n){if(e){var i=(0,r.newError)("Driver is connected to the database that does not support multiple databases. Please upgrade to neo4j 4.0.0 or later in order to use this functionality");throw t._handleFatalError(i),n.onError(i),i}},t.assertTxConfigIsEmpty=function(e,t,n){if(e&&!e.isEmpty()){var i=(0,r.newError)("Driver is connected to the database that does not support transaction configuration. Please upgrade to neo4j 3.5.0 or later in order to use this functionality");throw t._handleFatalError(i),n.onError(i),i}};var r=n(22);n(66)},250:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.Dechunker=t.Chunker=void 0;var i=r(n(6)),o=r(n(8)),a=r(n(31)),u=r(n(32)),s=r(n(27)),c=r(n(202)),l=n(112),f=r(n(337));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}var d=function(e){(0,a.default)(n,e);var t=h(n);function n(e,r){var o;return(0,i.default)(this,n),(o=t.call(this,0))._bufferSize=r||1400,o._ch=e,o._buffer=(0,l.alloc)(o._bufferSize),o._currentChunkStart=0,o._chunkOpen=!1,o}return(0,o.default)(n,[{key:"putUInt8",value:function(e,t){this._ensure(1),this._buffer.writeUInt8(t)}},{key:"putInt8",value:function(e,t){this._ensure(1),this._buffer.writeInt8(t)}},{key:"putFloat64",value:function(e,t){this._ensure(8),this._buffer.writeFloat64(t)}},{key:"putBytes",value:function(e,t){for(;t.remaining()>0;)this._ensure(1),this._buffer.remaining()>t.remaining()?this._buffer.writeBytes(t):this._buffer.writeBytes(t.readSlice(this._buffer.remaining()));return this}},{key:"flush",value:function(){if(this._buffer.position>0){this._closeChunkIfOpen();var e=this._buffer;this._buffer=null,this._ch.write(e.getSlice(0,e.position)),this._buffer=(0,l.alloc)(this._bufferSize),this._chunkOpen=!1}return this}},{key:"messageBoundary",value:function(){this._closeChunkIfOpen(),this._buffer.remaining()<2&&this.flush(),this._buffer.writeInt16(0)}},{key:"_ensure",value:function(e){var t=this._chunkOpen?e:e+2;this._buffer.remaining()<t&&this.flush(),this._chunkOpen||(this._currentChunkStart=this._buffer.position,this._buffer.position=this._buffer.position+2,this._chunkOpen=!0)}},{key:"_closeChunkIfOpen",value:function(){if(this._chunkOpen){var e=this._buffer.position-(this._currentChunkStart+2);this._buffer.putUInt16(this._currentChunkStart,e),this._chunkOpen=!1}}}]),n}(c.default);t.Chunker=d;var v=function(){function e(){(0,i.default)(this,e),this._currentMessage=[],this._partialChunkHeader=0,this._state=this.AWAITING_CHUNK}return(0,o.default)(e,[{key:"AWAITING_CHUNK",value:function(e){return e.remaining()>=2?this._onHeader(e.readUInt16()):(this._partialChunkHeader=e.readUInt8()<<8,this.IN_HEADER)}},{key:"IN_HEADER",value:function(e){return this._onHeader(65535&(this._partialChunkHeader|e.readUInt8()))}},{key:"IN_CHUNK",value:function(e){return this._chunkSize<=e.remaining()?(this._currentMessage.push(e.readSlice(this._chunkSize)),this.AWAITING_CHUNK):(this._chunkSize-=e.remaining(),this._currentMessage.push(e.readSlice(e.remaining())),this.IN_CHUNK)}},{key:"CLOSED",value:function(e){}},{key:"_onHeader",value:function(e){if(0===e){var t;switch(this._currentMessage.length){case 0:return this.AWAITING_CHUNK;case 1:t=this._currentMessage[0];break;default:t=new f.default(this._currentMessage)}return this._currentMessage=[],this.onmessage(t),this.AWAITING_CHUNK}return this._chunkSize=e,this.IN_CHUNK}},{key:"write",value:function(e){for(;e.hasRemaining();)this._state=this._state(e)}}]),e}();t.Dechunker=v},251:function(e,t,n){"use strict";var r=n(61),i=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.Structure=t.Unpacker=t.Packer=void 0;var o=i(n(154)),a=i(n(6)),u=i(n(8)),s=n(112),c=r(n(51)),l=n(22),f=n(242),h=function(){function e(t,n){(0,a.default)(this,e),this.signature=t,this.fields=n}return(0,u.default)(e,[{key:"toString",value:function(){for(var e="",t=0;t<this.fields.length;t++)t>0&&(e+=", "),e+=this.fields[t];return"Structure("+this.signature+", ["+e+"])"}}]),e}();t.Structure=h;var d=function(){function e(t){(0,a.default)(this,e),this._ch=t,this._byteArraysSupported=!0}return(0,u.default)(e,[{key:"packable",value:function(e){var t=this;if(null===e)return function(){return t._ch.writeUInt8(192)};if(!0===e)return function(){return t._ch.writeUInt8(195)};if(!1===e)return function(){return t._ch.writeUInt8(194)};if("number"==typeof e)return function(){return t.packFloat(e)};if("string"==typeof e)return function(){return t.packString(e)};if((0,c.isInt)(e))return function(){return t.packInteger(e)};if(e instanceof Int8Array)return function(){return t.packBytes(e)};if(e instanceof Array)return function(){t.packListHeader(e.length);for(var n=0;n<e.length;n++)t.packable(void 0===e[n]?null:e[n])()};if(function(e){if(null==e)return!1;return"function"==typeof e[Symbol.iterator]}(e))return this.packableIterable(e);if(e instanceof f.Node)return this._nonPackableValue("It is not allowed to pass nodes in query parameters, given: ".concat(e));if(e instanceof f.Relationship)return this._nonPackableValue("It is not allowed to pass relationships in query parameters, given: ".concat(e));if(e instanceof f.Path)return this._nonPackableValue("It is not allowed to pass paths in query parameters, given: ".concat(e));if(e instanceof h){for(var n=[],r=0;r<e.fields.length;r++)n[r]=this.packable(e.fields[r]);return function(){return t.packStruct(e.signature,n)}}return"object"===(0,o.default)(e)?function(){for(var n=Object.keys(e),r=0,i=0;i<n.length;i++)void 0!==e[n[i]]&&r++;t.packMapHeader(r);for(var o=0;o<n.length;o++){var a=n[o];void 0!==e[a]&&(t.packString(a),t.packable(e[a])())}}:this._nonPackableValue("Unable to pack the given value: ".concat(e))}},{key:"packableIterable",value:function(e){try{var t=Array.from(e);return this.packable(t)}catch(t){throw(0,l.newError)("Cannot pack given iterable, ".concat(t.message,": ").concat(e))}}},{key:"packStruct",value:function(e,t){t=t||[],this.packStructHeader(t.length,e);for(var n=0;n<t.length;n++)t[n]()}},{key:"packInteger",value:function(e){var t=e.high,n=e.low;e.greaterThanOrEqual(-16)&&e.lessThan(128)?this._ch.writeInt8(n):e.greaterThanOrEqual(-128)&&e.lessThan(-16)?(this._ch.writeUInt8(200),this._ch.writeInt8(n)):e.greaterThanOrEqual(-32768)&&e.lessThan(32768)?(this._ch.writeUInt8(201),this._ch.writeInt16(n)):e.greaterThanOrEqual(-2147483648)&&e.lessThan(2147483648)?(this._ch.writeUInt8(202),this._ch.writeInt32(n)):(this._ch.writeUInt8(203),this._ch.writeInt32(t),this._ch.writeInt32(n))}},{key:"packFloat",value:function(e){this._ch.writeUInt8(193),this._ch.writeFloat64(e)}},{key:"packString",value:function(e){var t=s.utf8.encode(e),n=t.length;if(n<16)this._ch.writeUInt8(128|n),this._ch.writeBytes(t);else if(n<256)this._ch.writeUInt8(208),this._ch.writeUInt8(n),this._ch.writeBytes(t);else if(n<65536)this._ch.writeUInt8(209),this._ch.writeUInt8(n/256>>0),this._ch.writeUInt8(n%256),this._ch.writeBytes(t);else{if(!(n<4294967296))throw(0,l.newError)("UTF-8 strings of size "+n+" are not supported");this._ch.writeUInt8(210),this._ch.writeUInt8((n/16777216>>0)%256),this._ch.writeUInt8((n/65536>>0)%256),this._ch.writeUInt8((n/256>>0)%256),this._ch.writeUInt8(n%256),this._ch.writeBytes(t)}}},{key:"packListHeader",value:function(e){if(e<16)this._ch.writeUInt8(144|e);else if(e<256)this._ch.writeUInt8(212),this._ch.writeUInt8(e);else if(e<65536)this._ch.writeUInt8(213),this._ch.writeUInt8((e/256>>0)%256),this._ch.writeUInt8(e%256);else{if(!(e<4294967296))throw(0,l.newError)("Lists of size "+e+" are not supported");this._ch.writeUInt8(214),this._ch.writeUInt8((e/16777216>>0)%256),this._ch.writeUInt8((e/65536>>0)%256),this._ch.writeUInt8((e/256>>0)%256),this._ch.writeUInt8(e%256)}}},{key:"packBytes",value:function(e){if(!this._byteArraysSupported)throw(0,l.newError)("Byte arrays are not supported by the database this driver is connected to");this.packBytesHeader(e.length);for(var t=0;t<e.length;t++)this._ch.writeInt8(e[t])}},{key:"packBytesHeader",value:function(e){if(e<256)this._ch.writeUInt8(204),this._ch.writeUInt8(e);else if(e<65536)this._ch.writeUInt8(205),this._ch.writeUInt8((e/256>>0)%256),this._ch.writeUInt8(e%256);else{if(!(e<4294967296))throw(0,l.newError)("Byte arrays of size "+e+" are not supported");this._ch.writeUInt8(206),this._ch.writeUInt8((e/16777216>>0)%256),this._ch.writeUInt8((e/65536>>0)%256),this._ch.writeUInt8((e/256>>0)%256),this._ch.writeUInt8(e%256)}}},{key:"packMapHeader",value:function(e){if(e<16)this._ch.writeUInt8(160|e);else if(e<256)this._ch.writeUInt8(216),this._ch.writeUInt8(e);else if(e<65536)this._ch.writeUInt8(217),this._ch.writeUInt8(e/256>>0),this._ch.writeUInt8(e%256);else{if(!(e<4294967296))throw(0,l.newError)("Maps of size "+e+" are not supported");this._ch.writeUInt8(218),this._ch.writeUInt8((e/16777216>>0)%256),this._ch.writeUInt8((e/65536>>0)%256),this._ch.writeUInt8((e/256>>0)%256),this._ch.writeUInt8(e%256)}}},{key:"packStructHeader",value:function(e,t){if(e<16)this._ch.writeUInt8(176|e),this._ch.writeUInt8(t);else if(e<256)this._ch.writeUInt8(220),this._ch.writeUInt8(e),this._ch.writeUInt8(t);else{if(!(e<65536))throw(0,l.newError)("Structures of size "+e+" are not supported");this._ch.writeUInt8(221),this._ch.writeUInt8(e/256>>0),this._ch.writeUInt8(e%256)}}},{key:"disableByteArrays",value:function(){this._byteArraysSupported=!1}},{key:"_nonPackableValue",value:function(e){return function(){throw(0,l.newError)(e,l.PROTOCOL_ERROR)}}}]),e}();t.Packer=d;var v=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];(0,a.default)(this,e),this._disableLosslessIntegers=t}return(0,u.default)(e,[{key:"unpack",value:function(e){var t=e.readUInt8(),n=240&t,r=15&t;if(192===t)return null;var i=this._unpackBoolean(t);if(null!==i)return i;var o=this._unpackNumberOrInteger(t,e);if(null!==o)return this._disableLosslessIntegers&&(0,c.isInt)(o)?o.toNumberOrInfinity():o;var a=this._unpackString(t,n,r,e);if(null!==a)return a;var u=this._unpackList(t,n,r,e);if(null!==u)return u;var s=this._unpackByteArray(t,e);if(null!==s)return s;var f=this._unpackMap(t,n,r,e);if(null!==f)return f;var h=this._unpackStruct(t,n,r,e);if(null!==h)return h;throw(0,l.newError)("Unknown packed value with marker "+t.toString(16))}},{key:"unpackInteger",value:function(e){var t=e.readUInt8(),n=this._unpackInteger(t,e);if(null==n)throw(0,l.newError)("Unable to unpack integer value with marker "+t.toString(16));return n}},{key:"_unpackBoolean",value:function(e){return 195===e||194!==e&&null}},{key:"_unpackNumberOrInteger",value:function(e,t){return 193===e?t.readFloat64():this._unpackInteger(e,t)}},{key:"_unpackInteger",value:function(e,t){if(e>=0&&e<128)return(0,c.int)(e);if(e>=240&&e<256)return(0,c.int)(e-256);if(200===e)return(0,c.int)(t.readInt8());if(201===e)return(0,c.int)(t.readInt16());if(202===e){var n=t.readInt32();return(0,c.int)(n)}if(203===e){var r=t.readInt32(),i=t.readInt32();return new c.default(i,r)}return null}},{key:"_unpackString",value:function(e,t,n,r){return 128===t?s.utf8.decode(r,n):208===e?s.utf8.decode(r,r.readUInt8()):209===e?s.utf8.decode(r,r.readUInt16()):210===e?s.utf8.decode(r,r.readUInt32()):null}},{key:"_unpackList",value:function(e,t,n,r){return 144===t?this._unpackListWithSize(n,r):212===e?this._unpackListWithSize(r.readUInt8(),r):213===e?this._unpackListWithSize(r.readUInt16(),r):214===e?this._unpackListWithSize(r.readUInt32(),r):null}},{key:"_unpackListWithSize",value:function(e,t){for(var n=[],r=0;r<e;r++)n.push(this.unpack(t));return n}},{key:"_unpackByteArray",value:function(e,t){return 204===e?this._unpackByteArrayWithSize(t.readUInt8(),t):205===e?this._unpackByteArrayWithSize(t.readUInt16(),t):206===e?this._unpackByteArrayWithSize(t.readUInt32(),t):null}},{key:"_unpackByteArrayWithSize",value:function(e,t){for(var n=new Int8Array(e),r=0;r<e;r++)n[r]=t.readInt8();return n}},{key:"_unpackMap",value:function(e,t,n,r){return 160===t?this._unpackMapWithSize(n,r):216===e?this._unpackMapWithSize(r.readUInt8(),r):217===e?this._unpackMapWithSize(r.readUInt16(),r):218===e?this._unpackMapWithSize(r.readUInt32(),r):null}},{key:"_unpackMapWithSize",value:function(e,t){for(var n={},r=0;r<e;r++){n[this.unpack(t)]=this.unpack(t)}return n}},{key:"_unpackStruct",value:function(e,t,n,r){return 176===t?this._unpackStructWithSize(n,r):220===e?this._unpackStructWithSize(r.readUInt8(),r):221===e?this._unpackStructWithSize(r.readUInt16(),r):null}},{key:"_unpackStructWithSize",value:function(e,t){var n=t.readUInt8();return 78===n?this._unpackNode(e,t):82===n?this._unpackRelationship(e,t):114===n?this._unpackUnboundRelationship(e,t):80===n?this._unpackPath(e,t):this._unpackUnknownStruct(n,e,t)}},{key:"_unpackNode",value:function(e,t){return this._verifyStructSize("Node",3,e),new f.Node(this.unpack(t),this.unpack(t),this.unpack(t))}},{key:"_unpackRelationship",value:function(e,t){return this._verifyStructSize("Relationship",5,e),new f.Relationship(this.unpack(t),this.unpack(t),this.unpack(t),this.unpack(t),this.unpack(t))}},{key:"_unpackUnboundRelationship",value:function(e,t){return this._verifyStructSize("UnboundRelationship",3,e),new f.UnboundRelationship(this.unpack(t),this.unpack(t),this.unpack(t))}},{key:"_unpackPath",value:function(e,t){this._verifyStructSize("Path",3,e);for(var n=this.unpack(t),r=this.unpack(t),i=this.unpack(t),o=[],a=n[0],u=0;u<i.length;u+=2){var s=n[i[u+1]],c=i[u],l=void 0;c>0?(l=r[c-1])instanceof f.UnboundRelationship&&(r[c-1]=l=l.bind(a.identity,s.identity)):(l=r[-c-1])instanceof f.UnboundRelationship&&(r[-c-1]=l=l.bind(s.identity,a.identity)),o.push(new f.PathSegment(a,l,s)),a=s}return new f.Path(n[0],n[n.length-1],o)}},{key:"_unpackUnknownStruct",value:function(e,t,n){for(var r=new h(e,[]),i=0;i<t;i++)r.fields.push(this.unpack(n));return r}},{key:"_verifyStructSize",value:function(e,t,n){if(t!==n)throw(0,l.newError)("Wrong struct size for ".concat(e,", expected ").concat(t," but was ").concat(n),l.PROTOCOL_ERROR)}}]),e}();t.Unpacker=v},252:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(86)),o=r(n(91)),a=r(n(6)),u=r(n(8)),s=r(n(155)),c=r(n(31)),l=r(n(32)),f=r(n(27)),h=r(n(205)),d=r(n(343)),v=r(n(207)),_=r(n(209)),p=n(22);function y(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,f.default)(e);if(t){var i=(0,f.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,l.default)(this,n)}}var m=function(e){(0,c.default)(r,e);var t,n=y(r);function r(e){var t,i=e.id,o=e.config,u=e.log,c=e.userAgent,l=e.authToken,f=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;return(0,a.default)(this,r),(t=n.call(this))._id=i,t._config=o,t._log=u,t._userAgent=c,t._authToken=l,t._createChannelConnection=f||function(e){return h.default.create(e,t._config,t._createConnectionErrorHandler(),t._log)},t._connectionPool=new d.default({create:t._createConnection.bind((0,s.default)(t)),destroy:t._destroyConnection.bind((0,s.default)(t)),validate:t._validateConnection.bind((0,s.default)(t)),installIdleObserver:r._installIdleObserverOnConnection.bind((0,s.default)(t)),removeIdleObserver:r._removeIdleObserverOnConnection.bind((0,s.default)(t)),config:v.default.fromDriverConfig(o),log:t._log}),t._openConnections={},t}return(0,u.default)(r,[{key:"_createConnectionErrorHandler",value:function(){return new _.default(p.SERVICE_UNAVAILABLE)}},{key:"_createConnection",value:function(e,t){var n=this,r=this._createChannelConnection(e);return r._release=function(){return t(e,r)},this._openConnections[r.id]=r,r.connect(this._userAgent,this._authToken).catch((function(e){throw n._destroyConnection(r),e}))}},{key:"_validateConnection",value:function(e){if(!e.isOpen())return!1;var t=this._config.maxConnectionLifetime;return Date.now()-e.creationTimestamp<=t}},{key:"_destroyConnection",value:function(e){return delete this._openConnections[e.id],e.close()}},{key:"close",value:(t=(0,o.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._connectionPool.close();case 2:return e.next=4,Promise.all(Object.values(this._openConnections).map((function(e){return e.close()})));case 4:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}],[{key:"_installIdleObserverOnConnection",value:function(e,t){e._queueObserver(t)}},{key:"_removeIdleObserverOnConnection",value:function(e){e._updateCurrentObserver()}}]),r}(r(n(204)).default);t.default=m},253:function(e,t,n){"use strict";var r=n(61),i=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(6)),a=i(n(8)),u=i(n(31)),s=i(n(32)),c=i(n(27)),l=i(n(158)),f=r(n(341)),h=n(62);function d(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var v=function(e){(0,u.default)(n,e);var t=d(n);function n(){return(0,o.default)(this,n),t.apply(this,arguments)}return(0,a.default)(n,[{key:"_createPacker",value:function(e){return new f.Packer(e)}},{key:"_createUnpacker",value:function(e){return new f.Unpacker(e)}},{key:"version",get:function(){return h.BOLT_PROTOCOL_V2}}]),n}(l.default);t.default=v},254:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.isPoint=function(e){return!0===(e&&e.__isPoint__)},t.Point=void 0;var i=r(n(6)),o=r(n(8)),a=n(40),u=function(){function e(t,n,r,o){(0,i.default)(this,e),this.srid=(0,a.assertNumberOrInteger)(t,"SRID"),this.x=(0,a.assertNumber)(n,"X coordinate"),this.y=(0,a.assertNumber)(r,"Y coordinate"),this.z=null==o?o:(0,a.assertNumber)(o,"Z coordinate"),Object.freeze(this)}return(0,o.default)(e,[{key:"toString",value:function(){return this.z||0===this.z?"Point{srid=".concat(s(this.srid),", x=").concat(s(this.x),", y=").concat(s(this.y),", z=").concat(s(this.z),"}"):"Point{srid=".concat(s(this.srid),", x=").concat(s(this.x),", y=").concat(s(this.y),"}")}}]),e}();function s(e){return Number.isInteger(e)?e+".0":e.toString()}t.Point=u,Object.defineProperty(u.prototype,"__isPoint__",{value:!0,enumerable:!1,configurable:!1,writable:!1})},255:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.normalizeSecondsForDuration=function(e,t){return(0,a.int)(e).add(E(t,1e9))},t.normalizeNanosecondsForDuration=function(e){return w(e,1e9)},t.localTimeToNanoOfDay=function(e,t,n,r){e=(0,a.int)(e),t=(0,a.int)(t),n=(0,a.int)(n),r=(0,a.int)(r);var i=e.multiply(36e11);return(i=(i=i.add(t.multiply(6e10))).add(n.multiply(1e9))).add(r)},t.nanoOfDayToLocalTime=m,t.localDateTimeToEpochSecond=function(e,t,n,r,i,o,u){var s=g(e,t,n),c=function(e,t,n){e=(0,a.int)(e),t=(0,a.int)(t),n=(0,a.int)(n);var r=e.multiply(3600);return(r=r.add(t.multiply(60))).add(n)}(r,i,o);return s.multiply(86400).add(c)},t.epochSecondAndNanoToLocalDateTime=function(e,t){var n=E(e,86400),r=w(e,86400).multiply(1e9).add(t),i=b(n),o=m(r);return new u.LocalDateTime(i.year,i.month,i.day,o.hour,o.minute,o.second,o.nanosecond)},t.dateToEpochDay=g,t.epochDayToDate=b,t.durationToIsoString=function(e,t,n,r){var i=O(e),o=O(t),u=function(e,t){var n,r;e=(0,a.int)(e),t=(0,a.int)(t);var i=e.isNegative(),o=t.greaterThan(0);n=i&&o?e.equals(-1)?"-0":e.add(1).toString():e.toString();o&&(r=I(i?t.negate().add(2e9).modulo(1e9):t.add(1e9).modulo(1e9)));return r?n+r:n}(n,r);return"P".concat(i,"M").concat(o,"DT").concat(u,"S")},t.timeToIsoString=function(e,t,n,r){var i=O(e,2),o=O(t,2),a=O(n,2),u=I(r);return"".concat(i,":").concat(o,":").concat(a).concat(u)},t.timeZoneOffsetToIsoString=function(e){if((e=(0,a.int)(e)).equals(0))return"Z";var t=e.isNegative();t&&(e=e.multiply(-1));var n=t?"-":"+",r=O(e.div(3600),2),i=O(e.div(60).modulo(60),2),o=e.modulo(60),u=o.equals(0)?null:O(o,2);return u?"".concat(n).concat(r,":").concat(i,":").concat(u):"".concat(n).concat(r,":").concat(i)},t.dateToIsoString=function(e,t,n){var r=(e=(0,a.int)(e)).isNegative();r&&(e=e.multiply(-1));var i=O(e,4);r&&(i="-"+i);var o=O(t,2),u=O(n,2);return"".concat(i,"-").concat(o,"-").concat(u)},t.totalNanoseconds=function(e,t){t=t||0;var n=1e6*e.getMilliseconds();return(0,a.isInt)(t)?t.add(n):t+n},t.timeZoneOffsetInSeconds=function(e){var t=e.getTimezoneOffset();if(0===t)return 0;return-1*t*60},t.assertValidYear=function(e){return k(e,f,"Year")},t.assertValidMonth=function(e){return k(e,h,"Month")},t.assertValidDay=function(e){return k(e,d,"Day")},t.assertValidHour=function(e){return k(e,v,"Hour")},t.assertValidMinute=function(e){return k(e,_,"Minute")},t.assertValidSecond=function(e){return k(e,p,"Second")},t.assertValidNanosecond=function(e){return k(e,y,"Nanosecond")};var i=r(n(6)),o=r(n(8)),a=n(51),u=n(206),s=n(40),c=n(22),l=function(){function e(t,n){(0,i.default)(this,e),this._minNumber=t,this._maxNumber=n,this._minInteger=(0,a.int)(t),this._maxInteger=(0,a.int)(n)}return(0,o.default)(e,[{key:"contains",value:function(e){return(0,a.isInt)(e)?e.greaterThanOrEqual(this._minInteger)&&e.lessThanOrEqual(this._maxInteger):e>=this._minNumber&&e<=this._maxNumber}},{key:"toString",value:function(){return"[".concat(this._minNumber,", ").concat(this._maxNumber,"]")}}]),e}(),f=new l(-999999999,999999999),h=new l(1,12),d=new l(1,31),v=new l(0,23),_=new l(0,59),p=new l(0,59),y=new l(0,999999999);function m(e){var t=(e=(0,a.int)(e)).div(36e11),n=(e=e.subtract(t.multiply(36e11))).div(6e10),r=(e=e.subtract(n.multiply(6e10))).div(1e9),i=e.subtract(r.multiply(1e9));return new u.LocalTime(t,n,r,i)}function g(e,t,n){e=(0,a.int)(e),t=(0,a.int)(t),n=(0,a.int)(n);var r=e.multiply(365);return r=(r=(r=e.greaterThanOrEqual(0)?r.add(e.add(3).div(4).subtract(e.add(99).div(100)).add(e.add(399).div(400))):r.subtract(e.div(-4).subtract(e.div(-100)).add(e.div(-400)))).add(t.multiply(367).subtract(362).div(12))).add(n.subtract(1)),t.greaterThan(2)&&(r=r.subtract(1),function(e){return!!(e=(0,a.int)(e)).modulo(4).equals(0)&&(!e.modulo(100).equals(0)||!!e.modulo(400).equals(0))}(e)||(r=r.subtract(1))),r.subtract(719528)}function b(e){var t=(e=(0,a.int)(e)).add(719528).subtract(60),n=(0,a.int)(0);if(t.lessThan(0)){var r=t.add(1).div(146097).subtract(1);n=r.multiply(400),t=t.add(r.multiply(-146097))}var i=t.multiply(400).add(591).div(146097),o=t.subtract(i.multiply(365).add(i.div(4)).subtract(i.div(100)).add(i.div(400)));o.lessThan(0)&&(i=i.subtract(1),o=t.subtract(i.multiply(365).add(i.div(4)).subtract(i.div(100)).add(i.div(400)))),i=i.add(n);var s=o,c=s.multiply(5).add(2).div(153),l=c.add(2).modulo(12).add(1),f=s.subtract(c.multiply(306).add(5).div(10)).add(1);return i=i.add(c.div(10)),new u.Date(i,l,f)}function k(e,t,n){if((0,s.assertNumberOrInteger)(e,n),!t.contains(e))throw(0,c.newError)("".concat(n," is expected to be in range ").concat(t," but was: ").concat(e));return e}function E(e,t){e=(0,a.int)(e),t=(0,a.int)(t);var n=e.div(t);return e.isPositive()!==t.isPositive()&&n.multiply(t).notEquals(e)&&(n=n.subtract(1)),n}function w(e,t){return e=(0,a.int)(e),t=(0,a.int)(t),e.subtract(E(e,t).multiply(t))}function I(e){return(e=(0,a.int)(e)).equals(0)?"":"."+O(e,9)}function O(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:void 0,n=(e=(0,a.int)(e)).isNegative();n&&(e=e.negate());var r=e.toString();if(t)for(;r.length<t;)r="0"+r;return n?"-"+r:r}},256:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=r(n(31)),u=r(n(32)),s=r(n(27)),c=r(n(253)),l=r(n(113)),f=n(249),h=n(66),d=n(62);function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}var _=new h.StreamObserver,p=function(e){(0,a.default)(n,e);var t=v(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"transformMetadata",value:function(e){return"t_first"in e&&(e.result_available_after=e.t_first,delete e.t_first),"t_last"in e&&(e.result_consumed_after=e.t_last,delete e.t_last),e}},{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userAgent,n=e.authToken,r=e.onError,i=e.onComplete,o=new h.LoginObserver({connection:this._connection,afterError:r,afterComplete:i});return this._connection.write(l.default.hello(t,n),o,!0),o}},{key:"prepareToClose",value:function(){this._connection.write(l.default.goodbye(),_,!0)}},{key:"beginTransaction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.bookmark,n=e.txConfig,r=e.database,i=e.mode,o=e.beforeError,a=e.afterError,u=e.beforeComplete,s=e.afterComplete,c=new h.ResultStreamObserver({connection:this._connection,beforeError:o,afterError:a,beforeComplete:u,afterComplete:s});return c.prepareToHandleSingleResponse(),(0,f.assertDatabaseIsEmpty)(r,this._connection,c),this._connection.write(l.default.begin({bookmark:t,txConfig:n,mode:i}),c,!0),c}},{key:"commitTransaction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.beforeError,n=e.afterError,r=e.beforeComplete,i=e.afterComplete,o=new h.ResultStreamObserver({connection:this._connection,beforeError:t,afterError:n,beforeComplete:r,afterComplete:i});return o.prepareToHandleSingleResponse(),this._connection.write(l.default.commit(),o,!0),o}},{key:"rollbackTransaction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.beforeError,n=e.afterError,r=e.beforeComplete,i=e.afterComplete,o=new h.ResultStreamObserver({connection:this._connection,beforeError:t,afterError:n,beforeComplete:r,afterComplete:i});return o.prepareToHandleSingleResponse(),this._connection.write(l.default.rollback(),o,!0),o}},{key:"run",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.bookmark,i=n.txConfig,o=n.database,a=n.mode,u=n.beforeKeys,s=n.afterKeys,c=n.beforeError,d=n.afterError,v=n.beforeComplete,_=n.afterComplete,p=n.flush,y=void 0===p||p,m=new h.ResultStreamObserver({connection:this._connection,beforeKeys:u,afterKeys:s,beforeError:c,afterError:d,beforeComplete:v,afterComplete:_});return(0,f.assertDatabaseIsEmpty)(o,this._connection,m),this._connection.write(l.default.runWithMetadata(e,t,{bookmark:r,txConfig:i,mode:a}),m,!1),this._connection.write(l.default.pullAll(),m,y),m}},{key:"version",get:function(){return d.BOLT_PROTOCOL_V3}}]),n}(c.default);t.default=p},257:function(e,t,n){"use strict";var r=n(61),i=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(6)),a=i(n(8)),u=i(n(31)),s=i(n(32)),c=i(n(27)),l=i(n(256)),f=r(n(113)),h=n(66),d=n(62);function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var _=function(e){(0,u.default)(n,e);var t=v(n);function n(){return(0,o.default)(this,n),t.apply(this,arguments)}return(0,a.default)(n,[{key:"beginTransaction",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.bookmark,n=e.txConfig,r=e.database,i=e.mode,o=e.beforeError,a=e.afterError,u=e.beforeComplete,s=e.afterComplete,c=new h.ResultStreamObserver({connection:this._connection,beforeError:o,afterError:a,beforeComplete:u,afterComplete:s});return c.prepareToHandleSingleResponse(),this._connection.write(f.default.begin({bookmark:t,txConfig:n,database:r,mode:i}),c,!0),c}},{key:"run",value:function(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},r=n.bookmark,i=n.txConfig,o=n.database,a=n.mode,u=n.beforeKeys,s=n.afterKeys,c=n.beforeError,l=n.afterError,d=n.beforeComplete,v=n.afterComplete,_=n.flush,p=void 0===_||_,y=n.reactive,m=void 0!==y&&y,g=n.fetchSize,b=void 0===g?f.ALL:g,k=new h.ResultStreamObserver({connection:this._connection,reactive:m,fetchSize:b,moreFunction:this._requestMore,discardFunction:this._requestDiscard,beforeKeys:u,afterKeys:s,beforeError:c,afterError:l,beforeComplete:d,afterComplete:v}),E=m;return this._connection.write(f.default.runWithMetadata(e,t,{bookmark:r,txConfig:i,database:o,mode:a}),k,E&&p),m||this._connection.write(f.default.pull({n:b}),k,p),k}},{key:"_requestMore",value:function(e,t,n,r){e.write(f.default.pull({stmtId:t,n:n}),r,!0)}},{key:"_requestDiscard",value:function(e,t,n){e.write(f.default.discard({stmtId:t}),n,!0)}},{key:"_noOp",value:function(){}},{key:"version",get:function(){return d.BOLT_PROTOCOL_V4_0}}]),n}(l.default);t.default=_},258:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=r(n(31)),u=r(n(32)),s=r(n(27));function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}var l=function(e){(0,a.default)(n,e);var t=c(n);function n(e,r){var o;return(0,i.default)(this,n),o=t.call(this,r),r&&(o._originalErrorHandler=e._errorHandler,e._errorHandler=o._errorHandler),o._delegate=e,o}return(0,o.default)(n,[{key:"isOpen",value:function(){return this._delegate.isOpen()}},{key:"protocol",value:function(){return this._delegate.protocol()}},{key:"connect",value:function(e,t){return this._delegate.connect(e,t)}},{key:"write",value:function(e,t,n){return this._delegate.write(e,t,n)}},{key:"resetAndFlush",value:function(){return this._delegate.resetAndFlush()}},{key:"close",value:function(){return this._delegate.close()}},{key:"_release",value:function(){return this._originalErrorHandler&&(this._delegate._errorHandler=this._originalErrorHandler),this._delegate._release()}},{key:"id",get:function(){return this._delegate.id}},{key:"databaseId",get:function(){return this._delegate.databaseId},set:function(e){this._delegate.databaseId=e}},{key:"server",get:function(){return this._delegate.server}},{key:"address",get:function(){return this._delegate.address}},{key:"version",get:function(){return this._delegate.version},set:function(e){this._delegate.version=e}}]),n}(r(n(157)).default);t.default=l},259:function(e,t,n){"use strict";var r=n(61),i=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(6)),a=i(n(8)),u=i(n(199)),s=n(40),c=r(n(156)),l=i(n(90)),f=i(n(134)),h=n(66),d=n(22),v=function(){function e(t){var n=t.connectionHolder,r=t.onClose,i=t.onBookmark,a=t.onConnection,u=t.reactive,s=t.fetchSize;(0,o.default)(this,e),this._connectionHolder=n,this._reactive=u,this._state=_.ACTIVE,this._onClose=r,this._onBookmark=i,this._onConnection=a,this._onError=this._onErrorCallback.bind(this),this._onComplete=this._onCompleteCallback.bind(this),this._fetchSize=s,this._results=[]}return(0,a.default)(e,[{key:"_begin",value:function(e,t){var n=this;this._connectionHolder.getConnection().then((function(r){return n._onConnection(),r.protocol().beginTransaction({bookmark:e,txConfig:t,mode:n._connectionHolder.mode(),database:n._connectionHolder.database(),beforeError:n._onError,afterComplete:n._onComplete})})).catch((function(e){return n._onError(e)}))}},{key:"run",value:function(e,t){var n=(0,s.validateQueryAndParameters)(e,t),r=n.validatedQuery,i=n.params,o=this._state.run(r,i,{connectionHolder:this._connectionHolder,onError:this._onError,onComplete:this._onComplete,onConnection:this._onConnection,reactive:this._reactive,fetchSize:this._fetchSize});return this._results.push(o),o}},{key:"commit",value:function(){var e=this._state.commit({connectionHolder:this._connectionHolder,onError:this._onError,onComplete:this._onComplete,onConnection:this._onConnection,pendingResults:this._results});return this._state=e.state,this._onClose(),new Promise((function(t,n){e.result.subscribe({onCompleted:function(){return t()},onError:function(e){return n(e)}})}))}},{key:"rollback",value:function(){var e=this._state.rollback({connectionHolder:this._connectionHolder,onError:this._onError,onComplete:this._onComplete,onConnection:this._onConnection,pendingResults:this._results});return this._state=e.state,this._onClose(),new Promise((function(t,n){e.result.subscribe({onCompleted:function(){return t()},onError:function(e){return n(e)}})}))}},{key:"isOpen",value:function(){return this._state===_.ACTIVE}},{key:"_onErrorCallback",value:function(e){return this._state=_.FAILED,this._onClose(),this._connectionHolder.releaseConnection()}},{key:"_onCompleteCallback",value:function(e){this._onBookmark(new l.default(e.bookmark))}}]),e}(),_={ACTIVE:{commit:function(e){return{result:p(!0,e.connectionHolder,e.onError,e.onComplete,e.onConnection,e.pendingResults),state:_.SUCCEEDED}},rollback:function(e){return{result:p(!1,e.connectionHolder,e.onError,e.onComplete,e.onConnection,e.pendingResults),state:_.ROLLED_BACK}},run:function(e,t,n){var r=n.connectionHolder,i=n.onError,o=n.onComplete,a=n.onConnection,u=n.reactive,s=n.fetchSize;return y(r.getConnection().then((function(n){return a(),n.protocol().run(e,t,{bookmark:l.default.empty(),txConfig:f.default.empty(),beforeError:i,afterComplete:o,reactive:u,fetchSize:s})})).catch((function(e){return new h.FailedObserver({error:e,onError:i})})),e,t)}},FAILED:{commit:function(e){e.connectionHolder;var t=e.onError;e.onComplete;return{result:y(new h.FailedObserver({error:(0,d.newError)("Cannot commit this transaction, because it has been rolled back either because of an error or explicit termination."),onError:t}),"COMMIT",{}),state:_.FAILED}},rollback:function(e){e.connectionHolder,e.onError,e.onComplete;return{result:y(new h.CompletedObserver,"ROLLBACK",{}),state:_.FAILED}},run:function(e,t,n){n.connectionHolder;var r=n.onError;n.onComplete;return y(new h.FailedObserver({error:(0,d.newError)("Cannot run query in this transaction, because it has been rolled back either because of an error or explicit termination."),onError:r}),e,t)}},SUCCEEDED:{commit:function(e){e.connectionHolder;var t=e.onError;e.onComplete;return{result:y(new h.FailedObserver({error:(0,d.newError)("Cannot commit this transaction, because it has already been committed."),onError:t}),"COMMIT",{}),state:_.SUCCEEDED}},rollback:function(e){e.connectionHolder;var t=e.onError;e.onComplete;return{result:y(new h.FailedObserver({error:(0,d.newError)("Cannot rollback this transaction, because it has already been committed."),onError:t}),"ROLLBACK",{}),state:_.SUCCEEDED}},run:function(e,t,n){n.connectionHolder;var r=n.onError;n.onComplete;return y(new h.FailedObserver({error:(0,d.newError)("Cannot run query in this transaction, because it has already been committed."),onError:r}),e,t)}},ROLLED_BACK:{commit:function(e){e.connectionHolder;var t=e.onError;e.onComplete;return{result:y(new h.FailedObserver({error:(0,d.newError)("Cannot commit this transaction, because it has already been rolled back."),onError:t}),"COMMIT",{}),state:_.ROLLED_BACK}},rollback:function(e){e.connectionHolder,e.onError,e.onComplete;return{result:y(new h.FailedObserver({error:(0,d.newError)("Cannot rollback this transaction, because it has already been rolled back.")}),"ROLLBACK",{}),state:_.ROLLED_BACK}},run:function(e,t,n){n.connectionHolder;var r=n.onError;n.onComplete;return y(new h.FailedObserver({error:(0,d.newError)("Cannot run query in this transaction, because it has already been rolled back."),onError:r}),e,t)}}};function p(e,t,n,r,i,o){var a=t.getConnection().then((function(t){return i(),o.forEach((function(e){return e._cancel()})),Promise.all(o).then((function(i){return e?t.protocol().commitTransaction({beforeError:n,afterComplete:r}):t.protocol().rollbackTransaction({beforeError:n,afterComplete:r})}))})).catch((function(e){return new h.FailedObserver({error:e,onError:n})}));return new u.default(a,e?"COMMIT":"ROLLBACK",{},t)}function y(e,t,n){return new u.default(Promise.resolve(e),t,n,c.EMPTY_CONNECTION_HOLDER)}var m=v;t.default=m},260:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=n(22),u=(r(n(200)),n(176)),s=n(236),c=(r(n(201)),0),l=1,f=2,h=function(){function e(t){(0,i.default)(this,e);var n=t.pipe((0,s.publishReplay)(1),(0,s.refCount)());this._result=n,this._keys=n.pipe((0,s.flatMap)((function(e){return(0,u.from)(e.keys())})),(0,s.publishReplay)(1),(0,s.refCount)()),this._records=new u.Subject,this._summary=new u.ReplaySubject,this._state=c}return(0,o.default)(e,[{key:"keys",value:function(){return this._keys}},{key:"records",value:function(){var e=this;return this._result.pipe((0,s.flatMap)((function(t){return new u.Observable((function(n){return e._startStreaming({result:t,recordsObserver:n})}))})))}},{key:"consume",value:function(){var e=this;return this._result.pipe((0,s.flatMap)((function(t){return new u.Observable((function(n){return e._startStreaming({result:t,summaryObserver:n})}))})))}},{key:"_startStreaming",value:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.result,r=t.recordsObserver,i=void 0===r?null:r,o=t.summaryObserver,u=void 0===o?null:o,s=[];return u&&s.push(this._summary.subscribe(u)),this._state<l?(this._state=l,i&&s.push(this._records.subscribe(i)),s.push({unsubscribe:function(){n._cancel&&n._cancel()}}),0===this._records.observers.length&&n._cancel(),n.subscribe({onNext:function(t){e._records.next(t)},onCompleted:function(t){e._records.complete(),e._summary.next(t),e._summary.complete(),e._state=f},onError:function(t){e._records.error(t),e._summary.error(t),e._state=f}})):i&&i.error((0,a.newError)("Streaming has already started/consumed with a previous records or summary subscription.")),function(){s.forEach((function(e){return e.unsubscribe()}))}}}]),e}();t.default=h},261:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(351)),o=r(n(6)),a=r(n(8)),u=n(51),s=n(114),c=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.database,r=t.routers,i=t.readers,a=t.writers,s=t.expirationTime;(0,o.default)(this,e),this.database=n,this.databaseName=n||"default database",this.routers=r||[],this.readers=i||[],this.writers=a||[],this.expirationTime=s||(0,u.int)(0)}return(0,a.default)(e,[{key:"forget",value:function(e){this.readers=l(this.readers,e),this.writers=l(this.writers,e)}},{key:"forgetRouter",value:function(e){this.routers=l(this.routers,e)}},{key:"forgetWriter",value:function(e){this.writers=l(this.writers,e)}},{key:"isStaleFor",value:function(e){return this.expirationTime.lessThan(Date.now())||this.routers.length<1||e===s.READ&&0===this.readers.length||e===s.WRITE&&0===this.writers.length}},{key:"isExpiredFor",value:function(e){return this.expirationTime.add(e).lessThan(Date.now())}},{key:"allServers",value:function(){return[].concat((0,i.default)(this.routers),(0,i.default)(this.readers),(0,i.default)(this.writers))}},{key:"toString",value:function(){return"RoutingTable["+"database=".concat(this.databaseName,", ")+"expirationTime=".concat(this.expirationTime,", ")+"currentTime=".concat(Date.now(),", ")+"routers=[".concat(this.routers,"], ")+"readers=[".concat(this.readers,"], ")+"writers=[".concat(this.writers,"]]")}}]),e}();function l(e,t){return e.filter((function(e){return e.asKey()!==t.asKey()}))}t.default=c},262:function(e,t,n){"use strict";var r=n(61),i=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(86)),a=i(n(91)),u=i(n(6)),s=i(n(8)),c=n(22),l=r(n(51)),f=(n(356),i(n(90)),i(n(159)),i(n(134))),h=i(n(210)),d="CALL dbms.cluster.routing.getRoutingTable($".concat("context",")"),v="CALL dbms.routing.getRoutingTable($".concat("context",", $").concat("database",")"),_=function(){function e(t,n){(0,u.default)(this,e),this._routingContext=t,this._initialAddress=n}var t;return(0,s.default)(e,[{key:"callRoutingProcedure",value:(t=(0,a.default)(o.default.mark((function e(t,n,r){var i;return o.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._callAvailableRoutingProcedure(t,n);case 3:return i=e.sent,e.next=6,t.close();case 6:return e.abrupt("return",i.records);case 9:if(e.prev=9,e.t0=e.catch(0),"Neo.ClientError.Database.DatabaseNotFound"!==e.t0.code){e.next=15;break}throw e.t0;case 15:if("Neo.ClientError.Procedure.ProcedureNotFound"!==e.t0.code){e.next=19;break}throw(0,c.newError)("Server at ".concat(r.asHostPort()," can't perform routing. Make sure you are connecting to a causal cluster"),c.SERVICE_UNAVAILABLE);case 19:return e.abrupt("return",null);case 20:case"end":return e.stop()}}),e,this,[[0,9]])}))),function(e,n,r){return t.apply(this,arguments)})},{key:"parseTtl",value:function(e,t){try{var n=(0,l.int)(Date.now()),r=(0,l.int)(e.get("ttl")).multiply(1e3).add(n);return r.lessThan(n)?l.default.MAX_VALUE:r}catch(n){throw(0,c.newError)("Unable to parse TTL entry from router ".concat(t," from record:\n").concat(JSON.stringify(e),"\nError message: ").concat(n.message),c.PROTOCOL_ERROR)}}},{key:"parseServers",value:function(e,t){try{var n=e.get("servers"),r=[],i=[],o=[];return n.forEach((function(e){var t=e.role,n=e.addresses;if("ROUTE"===t)r=p(n).map((function(e){return h.default.fromUrl(e)}));else if("WRITE"===t)o=p(n).map((function(e){return h.default.fromUrl(e)}));else{if("READ"!==t)throw(0,c.newError)('Unknown server role "'+t+'"',c.PROTOCOL_ERROR);i=p(n).map((function(e){return h.default.fromUrl(e)}))}})),{routers:r,readers:i,writers:o}}catch(n){throw(0,c.newError)("Unable to parse servers entry from router ".concat(t," from record:\n").concat(JSON.stringify(e),"\nError message: ").concat(n.message),c.PROTOCOL_ERROR)}}},{key:"_callAvailableRoutingProcedure",value:function(e,t){var n=this;return e._run(null,null,(function(r){var i,o;return r.protocol().version>=4?(i=v,(o={context:n._routingContext||{},database:t||null}).context.address=n._initialAddress):(i=d,o={context:n._routingContext}),r.protocol().run(i,o,{bookmark:e._lastBookmark,txConfig:f.default.empty(),mode:e._mode,database:e._database,afterComplete:e._onComplete})}))}}]),e}();function p(e){if(!Array.isArray(e))throw new TypeError("Array expected but got: "+e);return Array.from(e)}t.default=_},263:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=n(357),a=n(40),u=function e(t,n,r,o,a){(0,i.default)(this,e),this.scheme=t,this.host=n,this.port=r,this.hostAndPort=o,this.query=a};function s(e,t,n){if(!(e=(e||"").trim()))throw new Error("Illegal empty ".concat(t," in URL query '").concat(n,"'"));return e}function c(e){var t="["===e.charAt(0),n="]"===e.charAt(e.length-1);if(t||n){if(t&&n)return e;throw new Error("Illegal IPv6 address ".concat(e))}return"[".concat(e,"]")}function l(e){return"http"===e?7474:"https"===e?7473:7687}var f={parseDatabaseUrl:function(e){(0,a.assertString)(e,"URL");var t=function(e){if(-1===(e=e.trim()).indexOf("://"))return{schemeMissing:!0,url:"none://".concat(e)};return{schemeMissing:!1,url:e}}(e),n=(0,o.parse)(t.url),r=t.schemeMissing?null:function(e){if(e)return":"===(e=e.trim()).charAt(e.length-1)&&(e=e.substring(0,e.length-1)),e;return null}(n.scheme),i=function(e,t){if(!e)throw new Error("Unable to extract host from ".concat(t));return e.trim()}(n.host),f=function(e){if(!e)throw new Error("Illegal host ".concat(e));return e.indexOf(":")>=0?c(e):e}(i),h=function(e,t){var n=parseInt(e,10);return 0===n||n?n:l(t)}(n.port,r),d="".concat(f,":").concat(h),v=function(e,t){var n=function(e){(e=(e||"").trim())&&"?"===e.charAt(0)&&(e=e.substring(1,e.length));return e}(e),r={};n&&n.split("&").forEach((function(e){var n=e.split("=");if(2!==n.length)throw new Error("Invalid parameters: '".concat(n,"' in URL '").concat(t,"'."));var i=s(n[0],"key",t),o=s(n[1],"value",t);if(r[i])throw new Error("Duplicated query parameters with key '".concat(i,"' in URL '").concat(t,"'"));r[i]=o}));return r}(n.query,e);return new u(r,i,h,d,v)},defaultPortForScheme:l,formatIPv4Address:function(e,t){return"".concat(e,":").concat(t)},formatIPv6Address:function(e,t){var n=c(e);return"".concat(n,":").concat(t)}};t.default=f},264:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=r(n(31)),u=r(n(32)),s=r(n(27)),c=r(n(359));function l(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}var f=function(e){(0,a.default)(n,e);var t=l(n);function n(e){var r;return(0,i.default)(this,n),(r=t.call(this))._readersIndex=new c.default,r._writersIndex=new c.default,r._connectionPool=e,r}return(0,o.default)(n,[{key:"selectReader",value:function(e){return this._select(e,this._readersIndex)}},{key:"selectWriter",value:function(e){return this._select(e,this._writersIndex)}},{key:"_select",value:function(e,t){var n=e.length;if(0===n)return null;var r=t.next(n),i=r,o=null,a=Number.MAX_SAFE_INTEGER;do{var u=e[i],s=this._connectionPool.activeResourceCount(u);s<a&&(o=u,a=s),i===n-1?i=0:i++}while(i!==r);return o}}]),n}(r(n(360)).default);t.default=f},332:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=r(n(203)),u=n(22),s=n(40),c=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:h,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(e){return new WebSocket(e)};(0,i.default)(this,e),this._open=!0,this._pending=[],this._error=null,this._handleConnectionError=this._handleConnectionError.bind(this),this._config=t;var o=f(t,n),u=o.scheme,s=o.error;if(s)this._error=s;else{this._ws=l(u,t.address,r),this._ws.binaryType="arraybuffer";var c=this;this._ws.onclose=function(e){e&&!e.wasClean&&c._handleConnectionError()},this._ws.onopen=function(){c._clearConnectionTimeout();var e=c._pending;c._pending=null;for(var t=0;t<e.length;t++)c.write(e[t])},this._ws.onmessage=function(e){if(c.onmessage){var t=new a.default(e.data);c.onmessage(t)}},this._ws.onerror=this._handleConnectionError,this._connectionTimeoutFired=!1,this._connectionTimeoutId=this._setupConnectionTimeout()}}return(0,o.default)(e,[{key:"_handleConnectionError",value:function(){if(this._connectionTimeoutFired)return this._error=(0,u.newError)("Failed to establish connection in ".concat(this._config.connectionTimeout,"ms"),this._config.connectionErrorCode),void(this.onerror&&this.onerror(this._error));this._open&&(this._error=(0,u.newError)("WebSocket connection failure. Due to security constraints in your web browser, the reason for the failure is not available to this Neo4j Driver. Please use your browsers development console to determine the root cause of the failure. Common reasons include the database being unavailable, using the wrong connection URL or temporary network problems. If you have enabled encryption, ensure your browser is configured to trust the certificate Neo4j is configured to use. WebSocket `readyState` is: "+this._ws.readyState,this._config.connectionErrorCode),this.onerror&&this.onerror(this._error))}},{key:"write",value:function(e){if(null!==this._pending)this._pending.push(e);else{if(!(e instanceof a.default))throw(0,u.newError)("Don't know how to send buffer: "+e);try{this._ws.send(e._buffer)}catch(e){if(1===this._ws.readyState)throw e;this._handleConnectionError()}}}},{key:"close",value:function(){var e=this;return new Promise((function(t,n){e._ws&&3!==e._ws.readyState?(e._open=!1,e._clearConnectionTimeout(),e._ws.onclose=function(){return t()},e._ws.close()):t()}))}},{key:"_setupConnectionTimeout",value:function(){var e=this,t=this._config.connectionTimeout;if(t){var n=this._ws;return setTimeout((function(){1!==n.readyState&&(e._connectionTimeoutFired=!0,n.close())}),t)}return null}},{key:"_clearConnectionTimeout",value:function(){var e=this._connectionTimeoutId;(e||0===e)&&(this._connectionTimeoutFired=!1,this._connectionTimeoutId=null,clearTimeout(e))}}]),e}();function l(e,t,n){var r=e+"://"+t.asHostPort();try{return n(r)}catch(r){if(function(e,t){return"SyntaxError"===e.name&&(n=t.asHostPort(),"["===n.charAt(0)&&-1!==n.indexOf("]"));var n}(r,t))return n(function(e,t){var n=t.host().replace(new RegExp(":","g"),"-").replace("%","s")+".ipv6-literal.net";return"".concat(e,"://").concat(n,":").concat(t.port())}(e,t));throw r}}function f(e,t){var n=function(e){return!0===e.encrypted||e.encrypted===s.ENCRYPTION_ON}(e),r=function(e){return!1===e.encrypted||e.encrypted===s.ENCRYPTION_OFF}(e),i=e.trust,o=function(e){var t="function"==typeof e?e():"";return t&&t.toLowerCase().indexOf("https")>=0}(t);return function(e,t,n){e&&!n?console.warn("Neo4j driver is configured to use secure WebSocket on a HTTP web page. WebSockets might not work in a mixed content environment. Please consider configuring driver to not use encryption."):t&&n&&console.warn("Neo4j driver is configured to use insecure WebSocket on a HTTPS web page. WebSockets might not work in a mixed content environment. Please consider configuring driver to use encryption.")}(n,r,o),r?{scheme:"ws",error:null}:o?{scheme:"wss",error:null}:n?i&&"TRUST_SYSTEM_CA_SIGNED_CERTIFICATES"!==i?{scheme:null,error:(0,u.newError)("The browser version of this driver only supports one trust strategy, 'TRUST_SYSTEM_CA_SIGNED_CERTIFICATES'. "+i+' is not supported. Please either use TRUST_SYSTEM_CA_SIGNED_CERTIFICATES or disable encryption by setting `encrypted:"'+s.ENCRYPTION_OFF+'"` in the driver configuration.')}:{scheme:"wss",error:null}:{scheme:"ws",error:null}}function h(){return"undefined"!=typeof window&&window.location?window.location.protocol:null}t.default=c},333:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=r(n(31)),u=r(n(32)),s=r(n(27));function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}var l=function(e){(0,a.default)(n,e);var t=c(n);function n(){return(0,i.default)(this,n),t.apply(this,arguments)}return(0,o.default)(n,[{key:"resolve",value:function(e){return this._resolveToItself(e)}}]),n}(r(n(334)).default);t.default=l},334:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=function(){function e(){(0,i.default)(this,e)}return(0,o.default)(e,[{key:"resolve",value:function(){throw new Error("Abstract function")}},{key:"_resolveToItself",value:function(e){return Promise.resolve([e])}}]),e}();t.default=a},335:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(203)),o=n(336),a=new o.TextEncoder("utf-8"),u=new o.TextDecoder("utf-8");var s={encode:function(e){return new i.default(a.encode(e).buffer)},decode:function(e,t){if(e instanceof i.default)return u.decode(e.readView(Math.min(t,e.length-e.position)));for(var n=new i.default(t),r=0;r<t;r++)n.writeUInt8(e.readUInt8());return n.reset(),u.decode(n.readView(t))}};t.default=s},337:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=r(n(31)),u=r(n(32)),s=r(n(27)),c=r(n(202)),l=n(112);function f(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}var h=function(e){(0,a.default)(n,e);var t=f(n);function n(e){var r;(0,i.default)(this,n);for(var o=0,a=0;a<e.length;a++)o+=e[a].length;return(r=t.call(this,o))._buffers=e,r}return(0,o.default)(n,[{key:"getUInt8",value:function(e){for(var t=0;t<this._buffers.length;t++){var n=this._buffers[t];if(!(e>=n.length))return n.getUInt8(e);e-=n.length}}},{key:"getInt8",value:function(e){for(var t=0;t<this._buffers.length;t++){var n=this._buffers[t];if(!(e>=n.length))return n.getInt8(e);e-=n.length}}},{key:"getFloat64",value:function(e){for(var t=(0,l.alloc)(8),n=0;n<8;n++)t.putUInt8(n,this.getUInt8(e+n));return t.getFloat64(0)}}]),n}(c.default);t.default=h},338:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(86)),o=r(n(91)),a=r(n(6)),u=r(n(8)),s=r(n(31)),c=r(n(32)),l=r(n(27)),f=r(n(252)),h=r(n(258)),d=r(n(205)),v=n(62);function _(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,c.default)(this,n)}}var p=function(e){(0,s.default)(l,e);var t,n,r,c=_(l);function l(e){var t,n=e.id,r=e.config,i=e.log,o=e.address,u=e.userAgent,s=e.authToken;return(0,a.default)(this,l),(t=c.call(this,{id:n,config:r,log:i,userAgent:u,authToken:s}))._address=o,t}return(0,u.default)(l,[{key:"acquireConnection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};e.accessMode,e.database,e.bookmarks;return this._connectionPool.acquire(this._address).then((function(e){return new h.default(e,null)}))}},{key:"_hasProtocolVersion",value:(r=(0,o.default)(i.default.mark((function e(t){var n,r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n=d.default.create(this._address,this._config,this._createConnectionErrorHandler(),this._log),e.prev=1,e.next=4,n._negotiateProtocol();case 4:if(!(r=n.protocol())){e.next=7;break}return e.abrupt("return",t(r.version));case 7:return e.abrupt("return",!1);case 8:return e.prev=8,e.next=11,n.close();case 11:return e.finish(8);case 12:case"end":return e.stop()}}),e,this,[[1,,8,12]])}))),function(e){return r.apply(this,arguments)})},{key:"supportsMultiDb",value:(n=(0,o.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._hasProtocolVersion((function(e){return e>=v.BOLT_PROTOCOL_V4_0}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(){return n.apply(this,arguments)})},{key:"supportsTransactionConfig",value:(t=(0,o.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._hasProtocolVersion((function(e){return e>=v.BOLT_PROTOCOL_V3}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(){return t.apply(this,arguments)})}]),l}(f.default);t.default=p},339:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=n(22),a=n(40),u=[null,void 0,!0,!1,a.ENCRYPTION_ON,a.ENCRYPTION_OFF],s=[null,void 0,"TRUST_ALL_CERTIFICATES","TRUST_CUSTOM_CA_SIGNED_CERTIFICATES","TRUST_SYSTEM_CA_SIGNED_CERTIFICATES"];t.default=function e(t,n,r){(0,i.default)(this,e),this.address=t,this.encrypted=function(e){var t=e.encrypted;if(-1===u.indexOf(t))throw(0,o.newError)("Illegal value of the encrypted setting ".concat(t,". Expected one of ").concat(u));return t}(n),this.trust=function(e){var t=e.trust;if(-1===s.indexOf(t))throw(0,o.newError)("Illegal value of the trust setting ".concat(t,". Expected one of ").concat(s));return t}(n),this.trustedCertificates=function(e){return e.trustedCertificates||[]}(n),this.knownHostsPath=function(e){return e.knownHosts||null}(n),this.connectionErrorCode=r||o.SERVICE_UNAVAILABLE,this.connectionTimeout=function(e){var t=parseInt(e.connectionTimeout,10);return 0===t||t&&t<0?null:t||3e4}(n)}},340:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=n(112),u=n(22),s=r(n(158)),c=r(n(253)),l=r(n(256)),f=r(n(257)),h=r(n(342)),d=function(){function e(t,n,r,o,a){var u=arguments.length>5&&void 0!==arguments[5]?arguments[5]:null;(0,i.default)(this,e),this._connection=t,this._channel=n,this._chunker=r,this._disableLosslessIntegers=o,this._log=a,this._serversideRouting=u}return(0,o.default)(e,[{key:"writeHandshakeRequest",value:function(){var e;this._channel.write(((e=(0,a.alloc)(20)).writeInt32(1616949271),e.writeInt32(260),e.writeInt32(4),e.writeInt32(3),e.writeInt32(2),e.reset(),e))}},{key:"createNegotiatedProtocol",value:function(e){var t=[e.readUInt8(),e.readUInt8(),e.readUInt8(),e.readUInt8()];if(72===t[0]&&84===t[1]&&84===t[2]&&80===t[3])throw(0,u.newError)("Server responded HTTP. Make sure you are not trying to connect to the http endpoint (HTTP defaults to port 7474 whereas BOLT defaults to port 7687)");var n=Number(t[3]+"."+t[2]);return this._log.isDebugEnabled()&&this._log.debug("".concat(this._connection," negotiated protocol version ").concat(n)),this._createProtocolWithVersion(n)}},{key:"_createProtocolWithVersion",value:function(e){switch(e){case 1:return new s.default(this._connection,this._chunker,this._disableLosslessIntegers);case 2:return new c.default(this._connection,this._chunker,this._disableLosslessIntegers);case 3:return new l.default(this._connection,this._chunker,this._disableLosslessIntegers);case 4:return new f.default(this._connection,this._chunker,this._disableLosslessIntegers);case 4.1:return new h.default(this._connection,this._chunker,this._disableLosslessIntegers,this._serversideRouting);default:throw(0,u.newError)("Unknown Bolt protocol version: "+e)}}}]),e}();t.default=d},341:function(e,t,n){"use strict";var r=n(61),i=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.Unpacker=t.Packer=void 0;var o=i(n(6)),a=i(n(8)),u=i(n(244)),s=i(n(31)),c=i(n(32)),l=i(n(27)),f=r(n(251)),h=n(254),d=n(206),v=n(51),_=n(255);function p(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,c.default)(this,n)}}var y=function(e){(0,s.default)(n,e);var t=p(n);function n(){return(0,o.default)(this,n),t.apply(this,arguments)}return(0,a.default)(n,[{key:"disableByteArrays",value:function(){throw new Error("Bolt V2 should always support byte arrays")}},{key:"packable",value:function(e){var t=this;return(0,h.isPoint)(e)?function(){return r=t,void(null===(n=e).z||void 0===n.z?function(e,t){var n=[t.packable((0,v.int)(e.srid)),t.packable(e.x),t.packable(e.y)];t.packStruct(88,n)}(n,r):function(e,t){var n=[t.packable((0,v.int)(e.srid)),t.packable(e.x),t.packable(e.y),t.packable(e.z)];t.packStruct(89,n)}(n,r));var n,r}:(0,d.isDuration)(e)?function(){return n=e,r=t,i=(0,v.int)(n.months),o=(0,v.int)(n.days),a=(0,v.int)(n.seconds),u=(0,v.int)(n.nanoseconds),s=[r.packable(i),r.packable(o),r.packable(a),r.packable(u)],void r.packStruct(69,s);var n,r,i,o,a,u,s}:(0,d.isLocalTime)(e)?function(){return n=e,r=t,i=(0,_.localTimeToNanoOfDay)(n.hour,n.minute,n.second,n.nanosecond),o=[r.packable(i)],void r.packStruct(116,o);var n,r,i,o}:(0,d.isTime)(e)?function(){return n=e,r=t,i=(0,_.localTimeToNanoOfDay)(n.hour,n.minute,n.second,n.nanosecond),o=(0,v.int)(n.timeZoneOffsetSeconds),a=[r.packable(i),r.packable(o)],void r.packStruct(84,a);var n,r,i,o,a}:(0,d.isDate)(e)?function(){return n=e,r=t,i=(0,_.dateToEpochDay)(n.year,n.month,n.day),o=[r.packable(i)],void r.packStruct(68,o);var n,r,i,o}:(0,d.isLocalDateTime)(e)?function(){return n=e,r=t,i=(0,_.localDateTimeToEpochSecond)(n.year,n.month,n.day,n.hour,n.minute,n.second,n.nanosecond),o=(0,v.int)(n.nanosecond),a=[r.packable(i),r.packable(o)],void r.packStruct(100,a);var n,r,i,o,a}:(0,d.isDateTime)(e)?function(){return r=t,void((n=e).timeZoneId?function(e,t){var n=(0,_.localDateTimeToEpochSecond)(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),r=(0,v.int)(e.nanosecond),i=e.timeZoneId,o=[t.packable(n),t.packable(r),t.packable(i)];t.packStruct(102,o)}(n,r):function(e,t){var n=(0,_.localDateTimeToEpochSecond)(e.year,e.month,e.day,e.hour,e.minute,e.second,e.nanosecond),r=(0,v.int)(e.nanosecond),i=(0,v.int)(e.timeZoneOffsetSeconds),o=[t.packable(n),t.packable(r),t.packable(i)];t.packStruct(70,o)}(n,r));var n,r}:(0,u.default)((0,l.default)(n.prototype),"packable",this).call(this,e)}}]),n}(f.Packer);t.Packer=y;var m=function(e){(0,s.default)(n,e);var t=p(n);function n(){var e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];return(0,o.default)(this,n),t.call(this,e)}return(0,a.default)(n,[{key:"_unpackUnknownStruct",value:function(e,t,r){return 88===e?function(e,t,n){return e._verifyStructSize("Point2D",3,t),new h.Point(e.unpack(n),e.unpack(n),e.unpack(n),void 0)}(this,t,r):89===e?function(e,t,n){return e._verifyStructSize("Point3D",4,t),new h.Point(e.unpack(n),e.unpack(n),e.unpack(n),e.unpack(n))}(this,t,r):69===e?function(e,t,n){e._verifyStructSize("Duration",4,t);var r=e.unpack(n),i=e.unpack(n),o=e.unpack(n),a=e.unpack(n);return new d.Duration(r,i,o,a)}(this,t,r):116===e?function(e,t,n,r){e._verifyStructSize("LocalTime",1,t);var i=e.unpackInteger(n);return g((0,_.nanoOfDayToLocalTime)(i),r)}(this,t,r,this._disableLosslessIntegers):84===e?function(e,t,n,r){e._verifyStructSize("Time",2,t);var i=e.unpackInteger(n),o=e.unpackInteger(n),a=(0,_.nanoOfDayToLocalTime)(i);return g(new d.Time(a.hour,a.minute,a.second,a.nanosecond,o),r)}(this,t,r,this._disableLosslessIntegers):68===e?function(e,t,n,r){e._verifyStructSize("Date",1,t);var i=e.unpackInteger(n);return g((0,_.epochDayToDate)(i),r)}(this,t,r,this._disableLosslessIntegers):100===e?function(e,t,n,r){e._verifyStructSize("LocalDateTime",2,t);var i=e.unpackInteger(n),o=e.unpackInteger(n);return g((0,_.epochSecondAndNanoToLocalDateTime)(i,o),r)}(this,t,r,this._disableLosslessIntegers):70===e?function(e,t,n,r){e._verifyStructSize("DateTimeWithZoneOffset",3,t);var i=e.unpackInteger(n),o=e.unpackInteger(n),a=e.unpackInteger(n),u=(0,_.epochSecondAndNanoToLocalDateTime)(i,o);return g(new d.DateTime(u.year,u.month,u.day,u.hour,u.minute,u.second,u.nanosecond,a,null),r)}(this,t,r,this._disableLosslessIntegers):102===e?function(e,t,n,r){e._verifyStructSize("DateTimeWithZoneId",3,t);var i=e.unpackInteger(n),o=e.unpackInteger(n),a=e.unpack(n),u=(0,_.epochSecondAndNanoToLocalDateTime)(i,o);return g(new d.DateTime(u.year,u.month,u.day,u.hour,u.minute,u.second,u.nanosecond,null,a),r)}(this,t,r,this._disableLosslessIntegers):(0,u.default)((0,l.default)(n.prototype),"_unpackUnknownStruct",this).call(this,e,t,r,this._disableLosslessIntegers)}}]),n}(f.Unpacker);function g(e,t){if(!t)return e;var n=Object.create(Object.getPrototypeOf(e));for(var r in e)if(e.hasOwnProperty(r)){var i=e[r];n[r]=(0,v.isInt)(i)?i.toNumberOrInfinity():i}return Object.freeze(n),n}t.Unpacker=m},342:function(e,t,n){"use strict";var r=n(61),i=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(6)),a=i(n(8)),u=i(n(31)),s=i(n(32)),c=i(n(27)),l=i(n(257)),f=r(n(113)),h=n(62),d=n(66);function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,c.default)(e);if(t){var i=(0,c.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,s.default)(this,n)}}var _=function(e){(0,u.default)(n,e);var t=v(n);function n(e,r,i,a){var u;return(0,o.default)(this,n),(u=t.call(this,e,r,i))._serversideRouting=a,u}return(0,a.default)(n,[{key:"initialize",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.userAgent,n=e.authToken,r=e.onError,i=e.onComplete,o=new d.LoginObserver({connection:this._connection,afterError:r,afterComplete:i});return this._connection.write(f.default.hello(t,n,this._serversideRouting),o,!0),o}},{key:"version",get:function(){return h.BOLT_PROTOCOL_V4_1}}]),n}(l.default);t.default=_},343:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(86)),o=r(n(91)),a=r(n(6)),u=r(n(8)),s=r(n(207)),c=n(22),l=r(n(208)),f=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.create,r=void 0===n?function(e,t){return Promise.resolve()}:n,i=t.destroy,o=void 0===i?function(e){return Promise.resolve()}:i,u=t.validate,c=void 0===u?function(e){return!0}:u,f=t.installIdleObserver,h=void 0===f?function(e,t){}:f,d=t.removeIdleObserver,v=void 0===d?function(e){}:d,_=t.config,p=void 0===_?s.default.defaultConfig():_,y=t.log,m=void 0===y?l.default.noOp():y;(0,a.default)(this,e),this._create=r,this._destroy=o,this._validate=c,this._installIdleObserver=h,this._removeIdleObserver=v,this._maxSize=p.maxSize,this._acquisitionTimeout=p.acquisitionTimeout,this._pools={},this._pendingCreates={},this._acquireRequests={},this._activeResourceCounts={},this._release=this._release.bind(this),this._log=m,this._closed=!1}var t,n,r;return(0,u.default)(e,[{key:"acquire",value:function(e){var t=this;return this._acquire(e).then((function(n){var r=e.asKey();if(n)return h(r,t._activeResourceCounts),t._log.isDebugEnabled()&&t._log.debug("".concat(n," acquired from the pool ").concat(r)),n;var i=t._acquireRequests;return i[r]||(i[r]=[]),new Promise((function(n,o){var a,u=setTimeout((function(){var n=i[r];if(n&&(i[r]=n.filter((function(e){return e!==a}))),a.isCompleted());else{var o=t.activeResourceCount(e),u=t.has(e)?t._pools[r].length:0;a.reject((0,c.newError)("Connection acquisition timed out in ".concat(t._acquisitionTimeout," ms. Poos status: Active conn count = ").concat(o,", Idle conn count = ").concat(u,".")))}}),t._acquisitionTimeout);a=new v(r,n,o,u,t._log),i[r].push(a)}))}))}},{key:"purge",value:function(e){return this._purgeKey(e.asKey())}},{key:"close",value:function(){var e=this;return this._closed=!0,Promise.all(Object.keys(this._pools).map((function(t){return e._purgeKey(t)})))}},{key:"keepAll",value:function(e){var t=this,n=e.map((function(e){return e.asKey()})),r=Object.keys(this._pools).filter((function(e){return-1===n.indexOf(e)}));return Promise.all(r.map((function(e){return t._purgeKey(e)})))}},{key:"has",value:function(e){return e.asKey()in this._pools}},{key:"activeResourceCount",value:function(e){return this._activeResourceCounts[e.asKey()]||0}},{key:"_acquire",value:(r=(0,o.default)(i.default.mark((function e(t){var n,r,o,a;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._closed){e.next=2;break}throw(0,c.newError)("Pool is closed, it is no more able to serve requests.");case 2:n=t.asKey(),(r=this._pools[n])||(r=[],this._pools[n]=r,this._pendingCreates[n]=0);case 5:if(!r.length){e.next=16;break}if(o=r.pop(),!this._validate(o)){e.next=12;break}return this._removeIdleObserver&&this._removeIdleObserver(o),e.abrupt("return",Promise.resolve(o));case 12:return e.next=14,this._destroy(o);case 14:e.next=5;break;case 16:if(!(this._maxSize>0)){e.next=20;break}if(!(this.activeResourceCount(t)+this._pendingCreates[n]>=this._maxSize)){e.next=20;break}return e.abrupt("return",null);case 20:return this._pendingCreates[n]=this._pendingCreates[n]+1,e.prev=21,e.next=24,this._create(t,this._release);case 24:a=e.sent;case 25:return e.prev=25,this._pendingCreates[n]=this._pendingCreates[n]-1,e.finish(25);case 28:return e.abrupt("return",a);case 29:case"end":return e.stop()}}),e,this,[[21,,25,28]])}))),function(e){return r.apply(this,arguments)})},{key:"_release",value:(n=(0,o.default)(i.default.mark((function e(t,n){var r,o,a=this;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(r=t.asKey(),!(o=this._pools[r])){e.next=14;break}if(this._validate(n)){e.next=9;break}return this._log.isDebugEnabled()&&this._log.debug("".concat(n," destroyed and can't be released to the pool ").concat(r," because it is not functional")),e.next=7,this._destroy(n);case 7:e.next=12;break;case 9:this._installIdleObserver&&this._installIdleObserver(n,{onError:function(e){a._log.debug("Idle connection ".concat(n," destroyed because of error: ").concat(e));var t=a._pools[r];t&&(a._pools[r]=t.filter((function(e){return e!==n}))),a._destroy(n).catch((function(){}))}}),o.push(n),this._log.isDebugEnabled()&&this._log.debug("".concat(n," released to the pool ").concat(r));case 12:e.next=17;break;case 14:return this._log.isDebugEnabled()&&this._log.debug("".concat(n," destroyed and can't be released to the pool ").concat(r," because pool has been purged")),e.next=17,this._destroy(n);case 17:d(r,this._activeResourceCounts),this._processPendingAcquireRequests(t);case 19:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"_purgeKey",value:(t=(0,o.default)(i.default.mark((function e(t){var n,r;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:n=this._pools[t]||[];case 1:if(!n.length){e.next=8;break}return r=n.pop(),this._removeIdleObserver&&this._removeIdleObserver(r),e.next=6,this._destroy(r);case 6:e.next=1;break;case 8:delete this._pools[t];case 9:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})},{key:"_processPendingAcquireRequests",value:function(e){var t=this,n=e.asKey(),r=this._acquireRequests[n];if(r){var i=r.shift();i?this._acquire(e).catch((function(e){return i.reject(e),null})).then((function(r){r&&(i.isCompleted()?t._release(e,r):(h(n,t._activeResourceCounts),i.resolve(r)))})):delete this._acquireRequests[n]}}}]),e}();function h(e,t){var n=t[e]||0;t[e]=n+1}function d(e,t){var n=(t[e]||0)-1;n>0?t[e]=n:delete t[e]}var v=function(){function e(t,n,r,i,o){(0,a.default)(this,e),this._key=t,this._resolve=n,this._reject=r,this._timeoutId=i,this._log=o,this._completed=!1}return(0,u.default)(e,[{key:"isCompleted",value:function(){return this._completed}},{key:"resolve",value:function(e){this._completed||(this._completed=!0,clearTimeout(this._timeoutId),this._log.isDebugEnabled()&&this._log.debug("".concat(e," acquired from the pool ").concat(this._key)),this._resolve(e))}},{key:"reject",value:function(e){this._completed||(this._completed=!0,clearTimeout(this._timeoutId),this._reject(e))}}]),e}(),_=f;t.default=_},344:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=r(n(156)),u=n(114),s=(n(66),function(){function e(t){(0,i.default)(this,e),this._connectionProvider=t}return(0,o.default)(e,[{key:"verify",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.database,n=void 0===t?"":t;return c(this._connectionProvider,n)}}]),e}());function c(e,t){var n=new a.default({mode:u.READ,database:t,connectionProvider:e});return n.initializeConnection(),n.getConnection().then((function(e){return n.close().then((function(){return e.server}))})).catch((function(e){return n.close().catch((function(e){})).then((function(){return Promise.reject(e)}))}))}t.default=s},345:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=n(22),u=function(){function e(t,n,r,o){(0,i.default)(this,e),this._maxRetryTimeMs=s(t,3e4),this._initialRetryDelayMs=s(n,1e3),this._multiplier=s(r,2),this._jitterFactor=s(o,.2),this._inFlightTimeoutIds=[],this._verifyAfterConstruction()}return(0,o.default)(e,[{key:"execute",value:function(e,t){var n=this;return new Promise((function(r,i){n._executeTransactionInsidePromise(e,t,r,i)})).catch((function(r){var i=Date.now(),o=n._initialRetryDelayMs;return n._retryTransactionPromise(e,t,r,i,o)}))}},{key:"close",value:function(){this._inFlightTimeoutIds.forEach((function(e){return clearTimeout(e)})),this._inFlightTimeoutIds=[]}},{key:"_retryTransactionPromise",value:function(t,n,r,i,o){var a=this;return Date.now()-i>this._maxRetryTimeMs||!e._canRetryOn(r)?Promise.reject(r):new Promise((function(e,r){var i=a._computeDelayWithJitter(o),u=setTimeout((function(){a._inFlightTimeoutIds=a._inFlightTimeoutIds.filter((function(e){return e!==u})),a._executeTransactionInsidePromise(t,n,e,r)}),i);a._inFlightTimeoutIds.push(u)})).catch((function(e){var r=o*a._multiplier;return a._retryTransactionPromise(t,n,e,i,r)}))}},{key:"_executeTransactionInsidePromise",value:function(e,t,n,r){var i,o=this;try{i=e()}catch(e){return void r(e)}this._safeExecuteTransactionWork(i,t).then((function(e){return o._handleTransactionWorkSuccess(e,i,n,r)})).catch((function(e){return o._handleTransactionWorkFailure(e,i,r)}))}},{key:"_safeExecuteTransactionWork",value:function(e,t){try{var n=t(e);return Promise.resolve(n)}catch(e){return Promise.reject(e)}}},{key:"_handleTransactionWorkSuccess",value:function(e,t,n,r){t.isOpen()?t.commit().then((function(){n(e)})).catch((function(e){r(e)})):n(e)}},{key:"_handleTransactionWorkFailure",value:function(e,t,n){t.isOpen()?t.rollback().catch((function(e){})).then((function(){return n(e)})):n(e)}},{key:"_computeDelayWithJitter",value:function(e){var t=e*this._jitterFactor,n=e-t,r=e+t;return Math.random()*(r-n)+n}},{key:"_verifyAfterConstruction",value:function(){if(this._maxRetryTimeMs<0)throw(0,a.newError)("Max retry time should be >= 0: "+this._maxRetryTimeMs);if(this._initialRetryDelayMs<0)throw(0,a.newError)("Initial retry delay should >= 0: "+this._initialRetryDelayMs);if(this._multiplier<1)throw(0,a.newError)("Multiplier should be >= 1.0: "+this._multiplier);if(this._jitterFactor<0||this._jitterFactor>1)throw(0,a.newError)("Jitter factor should be in [0.0, 1.0]: "+this._jitterFactor)}}],[{key:"_canRetryOn",value:function(e){return e&&e instanceof a.Neo4jError&&e.code&&(e.code===a.SERVICE_UNAVAILABLE||e.code===a.SESSION_EXPIRED||this._isTransientError(e))}},{key:"_isTransientError",value:function(e){var t=e.code;return t.indexOf("TransientError")>=0&&("Neo.TransientError.Transaction.Terminated"!==t&&"Neo.TransientError.Transaction.LockClientStopped"!==t)}}]),e}();function s(e,t){return e||0===e?e:t}t.default=u},346:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=n(176),u=n(236),s=r(n(260)),c=(r(n(159)),r(n(347))),l=n(62),f=r(n(134)),h=r(n(348)),d=function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.session,r=t.config;(0,i.default)(this,e),this._session=n,this._retryLogic=v(r)}return(0,o.default)(e,[{key:"run",value:function(e,t,n){var r=this;return new s.default(new a.Observable((function(i){try{i.next(r._session.run(e,t,n)),i.complete()}catch(e){i.error(e)}return function(){}})))}},{key:"beginTransaction",value:function(e){return this._beginTransaction(this._session._mode,e)}},{key:"readTransaction",value:function(e,t){return this._runTransaction(l.ACCESS_MODE_READ,e,t)}},{key:"writeTransaction",value:function(e,t){return this._runTransaction(l.ACCESS_MODE_WRITE,e,t)}},{key:"close",value:function(){var e=this;return new a.Observable((function(t){e._session.close().then((function(){t.complete()})).catch((function(e){return t.error(e)}))}))}},{key:"lastBookmark",value:function(){return this._session.lastBookmark()}},{key:"_beginTransaction",value:function(e,t){var n=this,r=f.default.empty();return t&&(r=new f.default(t)),new a.Observable((function(t){try{t.next(new c.default(n._session._beginTransaction(e,r))),t.complete()}catch(e){t.error(e)}return function(){}}))}},{key:"_runTransaction",value:function(e,t,n){f.default.empty();return n&&new f.default(n),this._retryLogic.retry(this._beginTransaction(e,n).pipe((0,u.flatMap)((function(e){return(0,a.defer)((function(){try{return t(e)}catch(e){return(0,a.throwError)(e)}})).pipe((0,u.catchError)((function(t){return e.rollback().pipe((0,u.concat)((0,a.throwError)(t)))})),(0,u.concat)(e.commit()))}))))}}]),e}();function v(e){var t=e&&e.maxTransactionRetryTime?e.maxTransactionRetryTime:null;return new h.default({maxRetryTimeout:t})}t.default=d},347:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=n(176),u=r(n(260)),s=(r(n(259)),function(){function e(t){(0,i.default)(this,e),this._txc=t}return(0,o.default)(e,[{key:"run",value:function(e,t){var n=this;return new u.default(new a.Observable((function(r){try{r.next(n._txc.run(e,t)),r.complete()}catch(e){r.error(e)}return function(){}})))}},{key:"commit",value:function(){var e=this;return new a.Observable((function(t){e._txc.commit().then((function(){t.complete()})).catch((function(e){return t.error(e)}))}))}},{key:"rollback",value:function(){var e=this;return new a.Observable((function(t){e._txc.rollback().then((function(){t.complete()})).catch((function(e){return t.error(e)}))}))}}]),e}());t.default=s},348:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=n(22),u=n(176),s=n(236),c=(r(n(208)),function(){function e(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},n=t.maxRetryTimeout,r=void 0===n?3e4:n,o=t.initialDelay,a=void 0===o?1e3:o,u=t.delayMultiplier,s=void 0===u?2:u,c=t.delayJitter,f=void 0===c?.2:c,h=t.logger,d=void 0===h?null:h;(0,i.default)(this,e),this._maxRetryTimeout=l(r,3e4),this._initialDelay=l(a,1e3),this._delayMultiplier=l(s,2),this._delayJitter=l(f,.2),this._logger=d}return(0,o.default)(e,[{key:"retry",value:function(t){var n=this;return t.pipe((0,s.retryWhen)((function(t){var r=[],i=Date.now(),o=1,c=n._initialDelay;return t.pipe((0,s.flatMap)((function(t){if(!e._canRetryOn(t))return(0,u.throwError)(t);if(r.push(t),o>=2&&Date.now()-i>=n._maxRetryTimeout){var l=(0,a.newError)("Failed after retried for ".concat(o," times in ").concat(n._maxRetryTimeout," ms. Make sure that your database is online and retry again."),a.SERVICE_UNAVAILABLE);return l.seenErrors=r,(0,u.throwError)(l)}var f=n._computeNextDelay(c);return c*=n._delayMultiplier,o++,n._logger&&n._logger.warn("Transaction failed and will be retried in ".concat(f)),(0,u.of)(1).pipe((0,s.delay)(f))})))})))}},{key:"_computeNextDelay",value:function(e){var t=e*this._delayJitter;return e-t+2*t*Math.random()}}],[{key:"_canRetryOn",value:function(e){return e&&e.code&&(e.code===a.SERVICE_UNAVAILABLE||e.code===a.SESSION_EXPIRED||this._isTransientError(e))}},{key:"_isTransientError",value:function(e){var t=e.code;return t.indexOf("TransientError")>=0&&("Neo.TransientError.Transaction.Terminated"!==t&&"Neo.TransientError.Transaction.LockClientStopped"!==t)}}]),e}());function l(e,t){return e||0===e?e:t}t.default=c},349:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=r(n(31)),u=r(n(32)),s=r(n(27)),c=n(114),l=(n(22),r(n(350))),f=(r(n(264)),r(n(209)),r(n(361)));function h(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}function d(e){var t=e.resolver;if(t&&"function"!=typeof t)throw new TypeError("Configured resolver should be a function. Got: ".concat(t));return e}var v=function(e){(0,a.default)(n,e);var t=h(n);function n(e,r,o){var a,u=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{},s=arguments.length>4&&void 0!==arguments[4]?arguments[4]:{};return(0,i.default)(this,n),(a=t.call(this,e,o,u,d(s)))._routingContext=r,a}return(0,o.default)(n,[{key:"_afterConstruction",value:function(){this._log.info("Routing driver ".concat(this._id," created for server address ").concat(this._address))}},{key:"_createConnectionProvider",value:function(e,t,n){return new l.default({id:this._id,address:e,routingContext:this._routingContext,hostNameResolver:(r=this._config,new f.default(r.resolver)),config:this._config,log:this._log,userAgent:t,authToken:n});var r}},{key:"_supportsRouting",value:function(){return!0}}]),n}(c.Driver);t.default=v},350:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(86)),o=r(n(91)),a=r(n(6)),u=r(n(8)),s=r(n(31)),c=r(n(32)),l=r(n(27)),f=n(22),h=n(114),d=r(n(159)),v=r(n(261)),_=r(n(355)),p=r(n(262)),y=n(112),m=r(n(358)),g=r(n(252)),b=r(n(209)),k=r(n(258)),E=r(n(264)),w=r(n(90)),I=r(n(205)),O=n(51),S=n(62);function T(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,l.default)(e);if(t){var i=(0,l.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,c.default)(this,n)}}var C=(0,O.int)(3e4),R=function(e){(0,s.default)(L,e);var t,n,r,c,l,g,R,P,N,D,A,U,x=T(L);function L(e){var t,n=e.id,r=e.address,i=e.routingContext,o=e.hostNameResolver,u=e.config,s=e.log,c=e.userAgent,l=e.authToken,f=e.routingTablePurgeDelay;return(0,a.default)(this,L),(t=x.call(this,{id:n,config:u,log:s,userAgent:c,authToken:l},(function(e){return I.default.create(e,t._config,t._createConnectionErrorHandler(),t._log,i||{})})))._seedRouter=r,t._routingTables={},t._rediscovery=new _.default(new p.default(i,r.toString())),t._loadBalancingStrategy=new E.default(t._connectionPool),t._hostNameResolver=o,t._dnsResolver=new y.HostNameResolver,t._log=s,t._useSeedRouter=!0,t._routingTablePurgeDelay=f?(0,O.int)(f):C,t}return(0,u.default)(L,[{key:"_createConnectionErrorHandler",value:function(){return new b.default(f.SESSION_EXPIRED)}},{key:"_handleUnavailability",value:function(e,t,n){return this._log.warn("Routing driver ".concat(this._id," will forget ").concat(t," for database '").concat(n,"' because of an error ").concat(e.code," '").concat(e.message,"'")),this.forget(t,n||""),e}},{key:"_handleWriteFailure",value:function(e,t,n){return this._log.warn("Routing driver ".concat(this._id," will forget writer ").concat(t," for database '").concat(n,"' because of an error ").concat(e.code," '").concat(e.message,"'")),this.forgetWriter(t,n||""),(0,f.newError)("No longer possible to write to server at "+t,f.SESSION_EXPIRED)}},{key:"acquireConnection",value:(U=(0,o.default)(i.default.mark((function e(){var t,n,r,o,a,u,s,c,l,d=this,v=arguments;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=v.length>0&&void 0!==v[0]?v[0]:{},n=t.accessMode,r=t.database,o=t.bookmark,s=new b.default(f.SESSION_EXPIRED,(function(e,t){return d._handleUnavailability(e,t,r)}),(function(e,t){return d._handleWriteFailure(e,t,r)})),e.next=4,this._freshRoutingTable({accessMode:n,database:r||"",bookmark:o});case 4:if(c=e.sent,n!==h.READ){e.next=10;break}u=this._loadBalancingStrategy.selectReader(c.readers),a="read",e.next=16;break;case 10:if(n!==h.WRITE){e.next=15;break}u=this._loadBalancingStrategy.selectWriter(c.writers),a="write",e.next=16;break;case 15:throw(0,f.newError)("Illegal mode "+n);case 16:if(u){e.next=18;break}throw(0,f.newError)("Failed to obtain connection towards ".concat(a," server. Known routing table is: ").concat(c),f.SESSION_EXPIRED);case 18:return e.prev=18,e.next=21,this._acquireConnectionToServer(u,a,c);case 21:return l=e.sent,e.abrupt("return",new k.default(l,s));case 25:throw e.prev=25,e.t0=e.catch(18),s.handleAndTransformError(e.t0,u);case 29:case"end":return e.stop()}}),e,this,[[18,25]])}))),function(){return U.apply(this,arguments)})},{key:"_hasProtocolVersion",value:(A=(0,o.default)(i.default.mark((function e(t){var n,r,o,a,u;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._resolveSeedRouter(this._seedRouter);case 2:n=e.sent,o=0;case 4:if(!(o<n.length)){e.next=25;break}return a=I.default.create(n[o],this._config,this._createConnectionErrorHandler(),this._log),e.prev=6,e.next=9,a._negotiateProtocol();case 9:if(!(u=a.protocol())){e.next=12;break}return e.abrupt("return",t(u.version));case 12:return e.abrupt("return",!1);case 15:e.prev=15,e.t0=e.catch(6),r=e.t0;case 18:return e.prev=18,e.next=21,a.close();case 21:return e.finish(18);case 22:o++,e.next=4;break;case 25:if(!r){e.next=27;break}throw r;case 27:return e.abrupt("return",!1);case 28:case"end":return e.stop()}}),e,this,[[6,15,18,22]])}))),function(e){return A.apply(this,arguments)})},{key:"supportsMultiDb",value:(D=(0,o.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._hasProtocolVersion((function(e){return e>=S.BOLT_PROTOCOL_V4_0}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(){return D.apply(this,arguments)})},{key:"supportsTransactionConfig",value:(N=(0,o.default)(i.default.mark((function e(){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._hasProtocolVersion((function(e){return e>=S.BOLT_PROTOCOL_V3}));case 2:return e.abrupt("return",e.sent);case 3:case"end":return e.stop()}}),e,this)}))),function(){return N.apply(this,arguments)})},{key:"forget",value:function(e,t){t||""===t?this._routingTables[t].forget(e):Object.values(this._routingTables).forEach((function(t){return t.forget(e)})),this._connectionPool.purge(e).catch((function(){}))}},{key:"forgetWriter",value:function(e,t){t||""===t?this._routingTables[t].forgetWriter(e):Object.values(this._routingTables).forEach((function(t){return t.forgetWriter(e)}))}},{key:"_acquireConnectionToServer",value:function(e,t,n){return this._connectionPool.acquire(e)}},{key:"_freshRoutingTable",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.accessMode,n=e.database,r=e.bookmark,i=this._routingTables[n]||new v.default({database:n});return i.isStaleFor(t)?(this._log.info('Routing table is stale for database: "'.concat(n,'" and access mode: "').concat(t,'": ').concat(i)),this._refreshRoutingTable(i,r)):i}},{key:"_refreshRoutingTable",value:function(e,t){var n=e.routers;return this._useSeedRouter?this._fetchRoutingTableFromSeedRouterFallbackToKnownRouters(n,e,t):this._fetchRoutingTableFromKnownRoutersFallbackToSeedRouter(n,e,t)}},{key:"_fetchRoutingTableFromSeedRouterFallbackToKnownRouters",value:(P=(0,o.default)(i.default.mark((function e(t,n,r){var o,a;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return o=[],e.next=3,this._fetchRoutingTableUsingSeedRouter(o,this._seedRouter,n,r);case 3:if(!(a=e.sent)){e.next=8;break}this._useSeedRouter=!1,e.next=11;break;case 8:return e.next=10,this._fetchRoutingTableUsingKnownRouters(t,n,r);case 10:a=e.sent;case 11:return e.next=13,this._applyRoutingTableIfPossible(n,a);case 13:return e.abrupt("return",e.sent);case 14:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return P.apply(this,arguments)})},{key:"_fetchRoutingTableFromKnownRoutersFallbackToSeedRouter",value:(R=(0,o.default)(i.default.mark((function e(t,n,r){var o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchRoutingTableUsingKnownRouters(t,n,r);case 2:if(o=e.sent){e.next=7;break}return e.next=6,this._fetchRoutingTableUsingSeedRouter(t,this._seedRouter,n,r);case 6:o=e.sent;case 7:return e.next=9,this._applyRoutingTableIfPossible(n,o);case 9:return e.abrupt("return",e.sent);case 10:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return R.apply(this,arguments)})},{key:"_fetchRoutingTableUsingKnownRouters",value:(g=(0,o.default)(i.default.mark((function e(t,n,r){var o,a;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._fetchRoutingTable(t,n,r);case 2:if(!(o=e.sent)){e.next=5;break}return e.abrupt("return",o);case 5:return a=t.length-1,L._forgetRouter(n,t,a),e.abrupt("return",null);case 8:case"end":return e.stop()}}),e,this)}))),function(e,t,n){return g.apply(this,arguments)})},{key:"_fetchRoutingTableUsingSeedRouter",value:(l=(0,o.default)(i.default.mark((function e(t,n,r,o){var a,u;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._resolveSeedRouter(n);case 2:return a=e.sent,u=a.filter((function(e){return t.indexOf(e)<0})),e.next=6,this._fetchRoutingTable(u,r,o);case 6:return e.abrupt("return",e.sent);case 7:case"end":return e.stop()}}),e,this)}))),function(e,t,n,r){return l.apply(this,arguments)})},{key:"_resolveSeedRouter",value:(c=(0,o.default)(i.default.mark((function e(t){var n,r,o=this;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._hostNameResolver.resolve(t);case 2:return n=e.sent,e.next=5,Promise.all(n.map((function(e){return o._dnsResolver.resolve(e)})));case 5:return r=e.sent,e.abrupt("return",[].concat.apply([],r));case 7:case"end":return e.stop()}}),e,this)}))),function(e){return c.apply(this,arguments)})},{key:"_fetchRoutingTable",value:function(e,t,n){var r=this;return e.reduce(function(){var a=(0,o.default)(i.default.mark((function o(a,u,s){var c,l,f;return i.default.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return i.next=2,a;case 2:if(!(c=i.sent)){i.next=7;break}return i.abrupt("return",c);case 7:l=s-1,L._forgetRouter(t,e,l);case 9:return i.next=11,r._createSessionForRediscovery(u,n);case 11:if(!(f=i.sent)){i.next=27;break}return i.prev=13,i.next=16,r._rediscovery.lookupRoutingTableOnRouter(f,t.database,u);case 16:return i.abrupt("return",i.sent);case 19:if(i.prev=19,i.t0=i.catch(13),!i.t0||"Neo.ClientError.Database.DatabaseNotFound"!==i.t0.code){i.next=23;break}throw i.t0;case 23:return r._log.warn("unable to fetch routing table because of an error ".concat(i.t0)),i.abrupt("return",null);case 25:i.next=28;break;case 27:return i.abrupt("return",null);case 28:case"end":return i.stop()}}),o,null,[[13,19]])})));return function(e,t,n){return a.apply(this,arguments)}}(),Promise.resolve(null))}},{key:"_createSessionForRediscovery",value:(r=(0,o.default)(i.default.mark((function e(t,n){var r,o;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this._connectionPool.acquire(t);case 3:if(r=e.sent,o=new m.default(r),!(r.protocol().version<4)){e.next=8;break}return e.abrupt("return",new d.default({mode:h.WRITE,bookmark:w.default.empty(),connectionProvider:o}));case 8:return e.abrupt("return",new d.default({mode:h.READ,database:"system",bookmark:n,connectionProvider:o}));case 11:if(e.prev=11,e.t0=e.catch(0),!e.t0||"Neo.ClientError.Security.Unauthorized"!==e.t0.code){e.next=15;break}throw e.t0;case 15:return e.abrupt("return",null);case 16:case"end":return e.stop()}}),e,this,[[0,11]])}))),function(e,t){return r.apply(this,arguments)})},{key:"_applyRoutingTableIfPossible",value:(n=(0,o.default)(i.default.mark((function e(t,n){return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n){e.next=2;break}throw(0,f.newError)("Could not perform discovery. No routing servers available. Known routing table: ".concat(t),f.SERVICE_UNAVAILABLE);case 2:return 0===n.writers.length&&(this._useSeedRouter=!0),e.next=5,this._updateRoutingTable(n);case 5:return e.abrupt("return",n);case 6:case"end":return e.stop()}}),e,this)}))),function(e,t){return n.apply(this,arguments)})},{key:"_updateRoutingTable",value:(t=(0,o.default)(i.default.mark((function e(t){var n=this;return i.default.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._connectionPool.keepAll(t.allServers());case 2:Object.values(this._routingTables).forEach((function(e){e.isExpiredFor(n._routingTablePurgeDelay)&&delete n._routingTables[e.database]})),this._routingTables[t.database]=t,this._log.info("Updated routing table ".concat(t));case 5:case"end":return e.stop()}}),e,this)}))),function(e){return t.apply(this,arguments)})}],[{key:"_forgetRouter",value:function(e,t,n){var r=t[n];e&&r&&e.forgetRouter(r)}}]),L}(g.default);t.default=R},355:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(86)),o=r(n(91)),a=r(n(6)),u=r(n(8)),s=r(n(261)),c=(r(n(262)),n(22)),l=function(){function e(t){(0,a.default)(this,e),this._routingUtil=t}var t;return(0,u.default)(e,[{key:"lookupRoutingTableOnRouter",value:(t=(0,o.default)(i.default.mark((function t(n,r,o){var a,u,l,f,h,d,v;return i.default.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this._routingUtil.callRoutingProcedure(n,r,o);case 2:if(null!==(a=t.sent)){t.next=5;break}return t.abrupt("return",null);case 5:if(1===a.length){t.next=7;break}throw(0,c.newError)('Illegal response from router "'+o+'". Received '+a.length+" records but expected only one.\n"+JSON.stringify(a),c.PROTOCOL_ERROR);case 7:return u=a[0],l=this._routingUtil.parseTtl(u,o),f=this._routingUtil.parseServers(u,o),h=f.routers,d=f.readers,v=f.writers,e._assertNonEmpty(h,"routers",o),e._assertNonEmpty(d,"readers",o),t.abrupt("return",new s.default({database:r,routers:h,readers:d,writers:v,expirationTime:l}));case 13:case"end":return t.stop()}}),t,this)}))),function(e,n,r){return t.apply(this,arguments)})}],[{key:"_assertNonEmpty",value:function(e,t,n){if(0===e.length)throw(0,c.newError)("Received no "+t+" from router "+n,c.PROTOCOL_ERROR)}}]),e}();t.default=l},356:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION_IN_DEV=t.VERSION_4_0_0=t.VERSION_3_5_0=t.VERSION_3_4_0=t.VERSION_3_2_0=t.ServerVersion=void 0;var i=r(n(6)),o=r(n(8)),a=n(40),u=new RegExp("^(Neo4j/)?(\\d+)\\.(\\d+)(?:\\.)?(\\d*)(\\.|-|\\+)?([0-9A-Za-z-.]*)?$"),s=function(){function e(t,n,r,o){(0,i.default)(this,e),this.major=t,this.minor=n,this.patch=r,this._originalVersionString=o}return(0,o.default)(e,[{key:"compareTo",value:function(e){var t=l(this.major,e.major);return 0===t&&0===(t=l(this.minor,e.minor))&&(t=l(this.patch,e.patch)),t}},{key:"toString",value:function(){return this._originalVersionString?this._originalVersionString:"".concat(this.major,".").concat(this.minor,".").concat(this.patch)}}],[{key:"fromDriver",value:function(t){var n=t.session();return n.run("RETURN 1").then((function(t){return n.close().then((function(){return e.fromString(t.summary.server.version)}))}))}},{key:"fromString",value:function(t){if(!t)return new e(3,0,0);if((0,a.assertString)(t,"Neo4j version string"),t.toLowerCase()==="Neo4j/dev".toLowerCase())return p;var n=t.match(u);if(!n)throw new Error("Unparsable Neo4j version: ".concat(t));return new e(c(n[2]),c(n[3]),c(n[4]||0),t)}}]),e}();function c(e,t){var n=parseInt(e,10);if(!n&&0!==n)throw new Error("Unparsable number ".concat(t,": '").concat(e,"'"));return n}function l(e,t){return e<t?-1:e===t?0:1}t.ServerVersion=s;var f=s.fromString("Neo4j/3.2.0");t.VERSION_3_2_0=f;var h=s.fromString("Neo4j/3.4.0");t.VERSION_3_4_0=h;var d=s.fromString("Neo4j/3.5.0");t.VERSION_3_5_0=d;var v=s.fromString("Neo4j/4.0.0");t.VERSION_4_0_0=v;var _=Number.MAX_SAFE_INTEGER,p=new s(_,_,_,"Neo4j/dev");t.VERSION_IN_DEV=p},358:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=r(n(31)),u=r(n(32)),s=r(n(27));function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}var l=function(e){(0,a.default)(n,e);var t=c(n);function n(e){var r;return(0,i.default)(this,n),(r=t.call(this))._connection=e,r}return(0,o.default)(n,[{key:"acquireConnection",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=(e.accessMode,e.database,e.bookmarks,this._connection);return this._connection=null,Promise.resolve(t)}}]),n}(r(n(204)).default);t.default=l},359:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=function(){function e(t){(0,i.default)(this,e),this._offset=t||0}return(0,o.default)(e,[{key:"next",value:function(e){if(0===e)return-1;var t=this._offset;return this._offset+=1,this._offset===Number.MAX_SAFE_INTEGER&&(this._offset=0),t%e}}]),e}();t.default=a},360:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=function(){function e(){(0,i.default)(this,e)}return(0,o.default)(e,[{key:"selectReader",value:function(e){throw new Error("Abstract function")}},{key:"selectWriter",value:function(e){throw new Error("Abstract function")}}]),e}();t.default=a},361:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=r(n(6)),o=r(n(8)),a=r(n(210));function u(e){return Promise.resolve([e])}var s=function(){function e(t){(0,i.default)(this,e),this._resolverFunction=t||u}return(0,o.default)(e,[{key:"resolve",value:function(e){var t=this;return new Promise((function(n){return n(t._resolverFunction(e.asHostPort()))})).then((function(e){if(!Array.isArray(e))throw new TypeError("Configured resolver function should either return an array of addresses or a Promise resolved with an array of addresses."+"Each address is '<host>:<port>'. Got: ".concat(e));return e.map((function(e){return a.default.fromUrl(e)}))}))}}]),e}();t.default=s},362:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;t.default="0.0.0-dev"},40:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.isEmptyObjectOrNull=function(e){if(null===e)return!0;if(!a(e))return!1;for(var t in e)if(e.hasOwnProperty(t))return!1;return!0},t.isObject=a,t.isString=s,t.assertObject=function(e,t){if(!a(e))throw new TypeError(t+" expected to be an object but was: "+JSON.stringify(e));return e},t.assertString=u,t.assertNumber=function(e,t){if("number"!=typeof e)throw new TypeError(t+" expected to be a number but was: "+JSON.stringify(e));return e},t.assertNumberOrInteger=function(e,t){if("number"!=typeof e&&!(0,o.isInt)(e))throw new TypeError(t+" expected to be either a number or an Integer object but was: "+JSON.stringify(e));return e},t.assertValidDate=function(e,t){if("[object Date]"!==Object.prototype.toString.call(e))throw new TypeError(t+" expected to be a standard JavaScript Date but was: "+JSON.stringify(e));if(Number.isNaN(e.getTime()))throw new TypeError(t+" expected to be valid JavaScript Date but its time was NaN: "+JSON.stringify(e));return e},t.validateQueryAndParameters=function(e,t){var n=e,r=t||{};"object"===(0,i.default)(e)&&e.text&&(n=e.text,r=e.parameters||{});return function(e){if(u(e,"Cypher query"),0===e.trim().length)throw new TypeError("Cypher query is expected to be a non-empty string.")}(n),function(e){if(!a(e)){var t=e.constructor?" "+e.constructor.name:"";throw new TypeError("Query parameters are expected to either be undefined/null or an object, given:".concat(t," ").concat(e))}}(r),{validatedQuery:n,params:r}},t.ENCRYPTION_OFF=t.ENCRYPTION_ON=void 0;var i=r(n(154)),o=n(51);t.ENCRYPTION_ON="ENCRYPTION_ON";function a(e){return"object"===(0,i.default)(e)&&!Array.isArray(e)&&null!==e}function u(e,t){if(!s(e))throw new TypeError(t+" expected to be string but was: "+JSON.stringify(e));return e}function s(e){return"[object String]"===Object.prototype.toString.call(e)}t.ENCRYPTION_OFF="ENCRYPTION_OFF"},51:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=t.toString=t.toNumber=t.inSafeRange=t.isInt=t.int=void 0;var i=r(n(6)),o=r(n(8)),a=n(22),u=function(){function e(t,n){(0,i.default)(this,e),this.low=0|t,this.high=0|n}return(0,o.default)(e,[{key:"inSafeRange",value:function(){return this.greaterThanOrEqual(e.MIN_SAFE_VALUE)&&this.lessThanOrEqual(e.MAX_SAFE_VALUE)}},{key:"toInt",value:function(){return this.low}},{key:"toNumber",value:function(){return this.high*c+(this.low>>>0)}},{key:"toNumberOrInfinity",value:function(){return this.lessThan(e.MIN_SAFE_VALUE)?Number.NEGATIVE_INFINITY:this.greaterThan(e.MAX_SAFE_VALUE)?Number.POSITIVE_INFINITY:this.toNumber()}},{key:"toString",value:function(t){if((t=t||10)<2||t>36)throw RangeError("radix out of range: "+t);if(this.isZero())return"0";var n;if(this.isNegative()){if(this.equals(e.MIN_VALUE)){var r=e.fromNumber(t),i=this.div(r);return n=i.multiply(r).subtract(this),i.toString(t)+n.toInt().toString(t)}return"-"+this.negate().toString(t)}var o=e.fromNumber(Math.pow(t,6));n=this;for(var a="";;){var u=n.div(o),s=(n.subtract(u.multiply(o)).toInt()>>>0).toString(t);if((n=u).isZero())return s+a;for(;s.length<6;)s="0"+s;a=""+s+a}}},{key:"getHighBits",value:function(){return this.high}},{key:"getLowBits",value:function(){return this.low}},{key:"getNumBitsAbs",value:function(){if(this.isNegative())return this.equals(e.MIN_VALUE)?64:this.negate().getNumBitsAbs();for(var t=0!==this.high?this.high:this.low,n=31;n>0&&0==(t&1<<n);n--);return 0!==this.high?n+33:n+1}},{key:"isZero",value:function(){return 0===this.high&&0===this.low}},{key:"isNegative",value:function(){return this.high<0}},{key:"isPositive",value:function(){return this.high>=0}},{key:"isOdd",value:function(){return 1==(1&this.low)}},{key:"isEven",value:function(){return 0==(1&this.low)}},{key:"equals",value:function(t){return e.isInteger(t)||(t=e.fromValue(t)),this.high===t.high&&this.low===t.low}},{key:"notEquals",value:function(e){return!this.equals(e)}},{key:"lessThan",value:function(e){return this.compare(e)<0}},{key:"lessThanOrEqual",value:function(e){return this.compare(e)<=0}},{key:"greaterThan",value:function(e){return this.compare(e)>0}},{key:"greaterThanOrEqual",value:function(e){return this.compare(e)>=0}},{key:"compare",value:function(t){if(e.isInteger(t)||(t=e.fromValue(t)),this.equals(t))return 0;var n=this.isNegative(),r=t.isNegative();return n&&!r?-1:!n&&r?1:this.subtract(t).isNegative()?-1:1}},{key:"negate",value:function(){return this.equals(e.MIN_VALUE)?e.MIN_VALUE:this.not().add(e.ONE)}},{key:"add",value:function(t){e.isInteger(t)||(t=e.fromValue(t));var n=this.high>>>16,r=65535&this.high,i=this.low>>>16,o=65535&this.low,a=t.high>>>16,u=65535&t.high,s=t.low>>>16,c=0,l=0,f=0,h=0;return f+=(h+=o+(65535&t.low))>>>16,h&=65535,l+=(f+=i+s)>>>16,f&=65535,c+=(l+=r+u)>>>16,l&=65535,c+=n+a,c&=65535,e.fromBits(f<<16|h,c<<16|l)}},{key:"subtract",value:function(t){return e.isInteger(t)||(t=e.fromValue(t)),this.add(t.negate())}},{key:"multiply",value:function(t){if(this.isZero())return e.ZERO;if(e.isInteger(t)||(t=e.fromValue(t)),t.isZero())return e.ZERO;if(this.equals(e.MIN_VALUE))return t.isOdd()?e.MIN_VALUE:e.ZERO;if(t.equals(e.MIN_VALUE))return this.isOdd()?e.MIN_VALUE:e.ZERO;if(this.isNegative())return t.isNegative()?this.negate().multiply(t.negate()):this.negate().multiply(t).negate();if(t.isNegative())return this.multiply(t.negate()).negate();if(this.lessThan(f)&&t.lessThan(f))return e.fromNumber(this.toNumber()*t.toNumber());var n=this.high>>>16,r=65535&this.high,i=this.low>>>16,o=65535&this.low,a=t.high>>>16,u=65535&t.high,s=t.low>>>16,c=65535&t.low,l=0,h=0,d=0,v=0;return d+=(v+=o*c)>>>16,v&=65535,h+=(d+=i*c)>>>16,d&=65535,h+=(d+=o*s)>>>16,d&=65535,l+=(h+=r*c)>>>16,h&=65535,l+=(h+=i*s)>>>16,h&=65535,l+=(h+=o*u)>>>16,h&=65535,l+=n*c+r*s+i*u+o*a,l&=65535,e.fromBits(d<<16|v,l<<16|h)}},{key:"div",value:function(t){if(e.isInteger(t)||(t=e.fromValue(t)),t.isZero())throw(0,a.newError)("division by zero");if(this.isZero())return e.ZERO;var n,r,i;if(this.equals(e.MIN_VALUE))return t.equals(e.ONE)||t.equals(e.NEG_ONE)?e.MIN_VALUE:t.equals(e.MIN_VALUE)?e.ONE:(n=this.shiftRight(1).div(t).shiftLeft(1)).equals(e.ZERO)?t.isNegative()?e.ONE:e.NEG_ONE:(r=this.subtract(t.multiply(n)),i=n.add(r.div(t)));if(t.equals(e.MIN_VALUE))return e.ZERO;if(this.isNegative())return t.isNegative()?this.negate().div(t.negate()):this.negate().div(t).negate();if(t.isNegative())return this.div(t.negate()).negate();for(i=e.ZERO,r=this;r.greaterThanOrEqual(t);){n=Math.max(1,Math.floor(r.toNumber()/t.toNumber()));for(var o=Math.ceil(Math.log(n)/Math.LN2),u=o<=48?1:Math.pow(2,o-48),s=e.fromNumber(n),c=s.multiply(t);c.isNegative()||c.greaterThan(r);)n-=u,c=(s=e.fromNumber(n)).multiply(t);s.isZero()&&(s=e.ONE),i=i.add(s),r=r.subtract(c)}return i}},{key:"modulo",value:function(t){return e.isInteger(t)||(t=e.fromValue(t)),this.subtract(this.div(t).multiply(t))}},{key:"not",value:function(){return e.fromBits(~this.low,~this.high)}},{key:"and",value:function(t){return e.isInteger(t)||(t=e.fromValue(t)),e.fromBits(this.low&t.low,this.high&t.high)}},{key:"or",value:function(t){return e.isInteger(t)||(t=e.fromValue(t)),e.fromBits(this.low|t.low,this.high|t.high)}},{key:"xor",value:function(t){return e.isInteger(t)||(t=e.fromValue(t)),e.fromBits(this.low^t.low,this.high^t.high)}},{key:"shiftLeft",value:function(t){return e.isInteger(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?e.fromBits(this.low<<t,this.high<<t|this.low>>>32-t):e.fromBits(0,this.low<<t-32)}},{key:"shiftRight",value:function(t){return e.isInteger(t)&&(t=t.toInt()),0==(t&=63)?this:t<32?e.fromBits(this.low>>>t|this.high<<32-t,this.high>>t):e.fromBits(this.high>>t-32,this.high>=0?0:-1)}}]),e}();u.__isInteger__=!0,Object.defineProperty(u.prototype,"__isInteger__",{value:!0,enumerable:!1,configurable:!1}),u.isInteger=function(e){return!0===(e&&e.__isInteger__)};var s={};u.fromInt=function(e){var t,n;return(e|=0)>=-128&&e<128&&(n=s[e])?n:(t=new u(e,e<0?-1:0,!1),e>=-128&&e<128&&(s[e]=t),t)},u.fromNumber=function(e){return isNaN(e)||!isFinite(e)?u.ZERO:e<=-l?u.MIN_VALUE:e+1>=l?u.MAX_VALUE:e<0?u.fromNumber(-e).negate():new u(e%c|0,e/c|0)},u.fromBits=function(e,t){return new u(e,t)},u.fromString=function(e,t){if(0===e.length)throw(0,a.newError)("number format error: empty string");if("NaN"===e||"Infinity"===e||"+Infinity"===e||"-Infinity"===e)return u.ZERO;if((t=t||10)<2||t>36)throw(0,a.newError)("radix out of range: "+t);var n;if((n=e.indexOf("-"))>0)throw(0,a.newError)('number format error: interior "-" character: '+e);if(0===n)return u.fromString(e.substring(1),t).negate();for(var r=u.fromNumber(Math.pow(t,8)),i=u.ZERO,o=0;o<e.length;o+=8){var s=Math.min(8,e.length-o),c=parseInt(e.substring(o,o+s),t);if(s<8){var l=u.fromNumber(Math.pow(t,s));i=i.multiply(l).add(u.fromNumber(c))}else i=(i=i.multiply(r)).add(u.fromNumber(c))}return i},u.fromValue=function(e){return e instanceof u?e:"number"==typeof e?u.fromNumber(e):"string"==typeof e?u.fromString(e):new u(e.low,e.high)},u.toNumber=function(e){return u.fromValue(e).toNumber()},u.toString=function(e,t){return u.fromValue(e).toString(t)},u.inSafeRange=function(e){return u.fromValue(e).inSafeRange()};var c=4294967296,l=c*c/2,f=u.fromInt(1<<24);u.ZERO=u.fromInt(0),u.ONE=u.fromInt(1),u.NEG_ONE=u.fromInt(-1),u.MAX_VALUE=u.fromBits(-1,2147483647,!1),u.MIN_VALUE=u.fromBits(0,-2147483648,!1),u.MIN_SAFE_VALUE=u.fromBits(1,-2097152),u.MAX_SAFE_VALUE=u.fromBits(-1,2097151);var h=u.fromValue;t.int=h;var d=u.isInteger;t.isInt=d;var v=u.inSafeRange;t.inSafeRange=v;var _=u.toNumber;t.toNumber=_;var p=u.toString;t.toString=p;var y=u;t.default=y},62:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.BOLT_PROTOCOL_V4_1=t.BOLT_PROTOCOL_V4_0=t.BOLT_PROTOCOL_V3=t.BOLT_PROTOCOL_V2=t.BOLT_PROTOCOL_V1=t.ACCESS_MODE_WRITE=t.ACCESS_MODE_READ=void 0;t.ACCESS_MODE_READ="READ";t.ACCESS_MODE_WRITE="WRITE";t.BOLT_PROTOCOL_V1=1;t.BOLT_PROTOCOL_V2=2;t.BOLT_PROTOCOL_V3=3;t.BOLT_PROTOCOL_V4_0=4;t.BOLT_PROTOCOL_V4_1=4.1},66:function(e,t,n){"use strict";var r=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.CompletedObserver=t.FailedObserver=t.ResetObserver=t.LoginObserver=t.ResultStreamObserver=t.StreamObserver=void 0;var i=r(n(155)),o=r(n(244)),a=r(n(31)),u=r(n(32)),s=r(n(27)),c=r(n(6)),l=r(n(8)),f=r(n(201)),h=(r(n(157)),n(22)),d=(r(n(51)),n(113));function v(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=(0,s.default)(e);if(t){var i=(0,s.default)(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return(0,u.default)(this,n)}}var _=function(){function e(){(0,c.default)(this,e)}return(0,l.default)(e,[{key:"onNext",value:function(e){}},{key:"onError",value:function(e){}},{key:"onCompleted",value:function(e){}}]),e}();t.StreamObserver=_;var p=function(e){(0,a.default)(n,e);var t=v(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=r.connection,o=r.reactive,a=void 0!==o&&o,u=r.moreFunction,s=r.discardFunction,l=r.fetchSize,f=void 0===l?d.ALL:l,h=r.beforeError,v=r.afterError,_=r.beforeKeys,p=r.afterKeys,y=r.beforeComplete,m=r.afterComplete;return(0,c.default)(this,n),(e=t.call(this))._connection=i,e._fieldKeys=null,e._fieldLookup=null,e._head=null,e._queuedRecords=[],e._tail=null,e._error=null,e._observers=[],e._meta={},e._beforeError=h,e._afterError=v,e._beforeKeys=_,e._afterKeys=p,e._beforeComplete=y,e._afterComplete=m,e._queryId=null,e._moreFunction=u,e._discardFunction=s,e._discard=!1,e._fetchSize=f,e._setState(a?k.READY:k.READY_STREAMING),e._setupAuoPull(f),e}return(0,l.default)(n,[{key:"onNext",value:function(e){var t=new f.default(this._fieldKeys,e,this._fieldLookup);this._observers.some((function(e){return e.onNext}))?this._observers.forEach((function(e){e.onNext&&e.onNext(t)})):(this._queuedRecords.push(t),this._queuedRecords.length>this._highRecordWatermark&&(this._autoPull=!1))}},{key:"onCompleted",value:function(e){this._state.onSuccess(this,e)}},{key:"onError",value:function(e){this._state.onError(this,e)}},{key:"cancel",value:function(){this._discard=!0}},{key:"prepareToHandleSingleResponse",value:function(){this._head=[],this._fieldKeys=[],this._setState(k.STREAMING)}},{key:"markCompleted",value:function(){this._head=[],this._fieldKeys=[],this._tail={},this._setState(k.SUCCEEDED)}},{key:"subscribe",value:function(e){if(this._error)e.onError(this._error);else{if(this._head&&e.onKeys&&e.onKeys(this._head),this._queuedRecords.length>0&&e.onNext)for(var t=0;t<this._queuedRecords.length;t++)e.onNext(this._queuedRecords[t]),this._queuedRecords.length-t-1<=this._lowRecordWatermark&&(this._autoPull=!0,this._state===k.READY&&this._handleStreaming());this._tail&&e.onCompleted&&e.onCompleted(this._tail),this._observers.push(e),this._state===k.READY&&this._handleStreaming()}}},{key:"_handleHasMore",value:function(e){this._setState(k.READY),this._handleStreaming(),delete e.has_more}},{key:"_handlePullSuccess",value:function(e){var t=this;this._setState(k.SUCCEEDED);var n=Object.assign(this._connection?{server:this._connection.server}:{},this._meta,e),r=null;this._beforeComplete&&(r=this._beforeComplete(n));var i=function(){t._tail=n,t._observers.some((function(e){return e.onCompleted}))&&t._observers.forEach((function(e){e.onCompleted&&e.onCompleted(n)})),t._afterComplete&&t._afterComplete(n)};r?Promise.resolve(r).then((function(){return i()})):i()}},{key:"_handleRunSuccess",value:function(e,t){var n=this;if(null===this._fieldKeys){if(this._fieldKeys=[],this._fieldLookup={},e.fields&&e.fields.length>0){this._fieldKeys=e.fields;for(var r=0;r<e.fields.length;r++)this._fieldLookup[e.fields[r]]=r;delete e.fields}e.qid&&(this._queryId=e.qid,delete e.qid),this._storeMetadataForCompletion(e);var i=null;this._beforeKeys&&(i=this._beforeKeys(this._fieldKeys));var o=function(){n._head=n._fieldKeys,n._observers.some((function(e){return e.onKeys}))&&n._observers.forEach((function(e){e.onKeys&&e.onKeys(n._fieldKeys)})),n._afterKeys&&n._afterKeys(n._fieldKeys),t()};i?Promise.resolve(i).then((function(){return o()})):o()}}},{key:"_handleError",value:function(e){var t=this;this._setState(k.FAILED),this._error=e;var n=null;this._beforeError&&(n=this._beforeError(e));var r=function(){t._observers.some((function(e){return e.onError}))&&t._observers.forEach((function(t){t.onError&&t.onError(e)})),t._afterError&&t._afterError(e)};n?Promise.resolve(n).then((function(){return r()})):r()}},{key:"_handleStreaming",value:function(){this._head&&this._observers.some((function(e){return e.onNext||e.onCompleted}))&&(this._discard?(this._discardFunction(this._connection,this._queryId,this),this._setState(k.STREAMING)):this._autoPull&&(this._moreFunction(this._connection,this._queryId,this._fetchSize,this),this._setState(k.STREAMING)))}},{key:"_storeMetadataForCompletion",value:function(e){for(var t=Object.keys(e),n=t.length,r="";n--;)r=t[n],this._meta[r]=e[r]}},{key:"_setState",value:function(e){this._state=e}},{key:"_setupAuoPull",value:function(e){this._autoPull=!0,e===d.ALL?(this._lowRecordWatermark=Number.MAX_VALUE,this._highRecordWatermark=Number.MAX_VALUE):(this._lowRecordWatermark=.3*e,this._highRecordWatermark=.7*e)}}]),n}(_);t.ResultStreamObserver=p;var y=function(e){(0,a.default)(n,e);var t=v(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=r.connection,o=r.beforeError,a=r.afterError,u=r.beforeComplete,s=r.afterComplete;return(0,c.default)(this,n),(e=t.call(this))._connection=i,e._beforeError=o,e._afterError=a,e._beforeComplete=u,e._afterComplete=s,e}return(0,l.default)(n,[{key:"onNext",value:function(e){this.onError((0,h.newError)("Received RECORD when initializing "+JSON.stringify(e)))}},{key:"onError",value:function(e){this._beforeError&&this._beforeError(e),this._connection._updateCurrentObserver(),this._connection._handleFatalError(e),this._afterError&&this._afterError(e)}},{key:"onCompleted",value:function(e){if(this._beforeComplete&&this._beforeComplete(e),e){var t=e.server;this._connection.version||(this._connection.version=t);var n=e.connection_id;this._connection.databaseId||(this._connection.databaseId=n)}this._afterComplete&&this._afterComplete(e)}}]),n}(_);t.LoginObserver=y;var m=function(e){(0,a.default)(n,e);var t=v(n);function n(){var e,r=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},i=r.connection,o=r.onError,a=r.onComplete;return(0,c.default)(this,n),(e=t.call(this))._connection=i,e._onError=o,e._onComplete=a,e}return(0,l.default)(n,[{key:"onNext",value:function(e){this.onError((0,h.newError)("Received RECORD when resetting: received record is: "+JSON.stringify(e),h.PROTOCOL_ERROR))}},{key:"onError",value:function(e){e.code===h.PROTOCOL_ERROR&&this._connection._handleProtocolError(e.message),this._onError&&this._onError(e)}},{key:"onCompleted",value:function(e){this._onComplete&&this._onComplete(e)}}]),n}(_);t.ResetObserver=m;var g=function(e){(0,a.default)(n,e);var t=v(n);function n(e){var r,i=e.error,o=e.onError;return(0,c.default)(this,n),(r=t.call(this,{beforeError:o})).onError(i),r}return n}(p);t.FailedObserver=g;var b=function(e){(0,a.default)(n,e);var t=v(n);function n(){var e,r;return(0,c.default)(this,n),r=t.call(this),(0,o.default)((e=(0,i.default)(r),(0,s.default)(n.prototype)),"markCompleted",e).call(e),r}return n}(p);t.CompletedObserver=b;var k={READY_STREAMING:{onSuccess:function(e,t){e._handleRunSuccess(t,(function(){e._setState(k.STREAMING)}))},onError:function(e,t){e._handleError(t)},name:function(){return"READY_STREAMING"}},READY:{onSuccess:function(e,t){e._handleRunSuccess(t,(function(){return e._handleStreaming()}))},onError:function(e,t){e._handleError(t)},name:function(){return"READY"}},STREAMING:{onSuccess:function(e,t){t.has_more?e._handleHasMore(t):e._handlePullSuccess(t)},onError:function(e,t){e._handleError(t)},name:function(){return"STREAMING"}},FAILED:{onError:function(e){},name:function(){return"FAILED"}},SUCCEEDED:{name:function(){return"SUCCEEDED"}}}},90:function(e,t,n){"use strict";var r=n(61),i=n(5);Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=i(n(243)),a=i(n(6)),u=i(n(8)),s=r(n(40)),c=function(){function e(t){(0,a.default)(this,e),this._values=function(e){if(!e)return[];if(s.isString(e))return[e];if(Array.isArray(e)){for(var t=[],n=function e(t){return t.reduce((function(t,n){return Array.isArray(n)?t.concat(e(n)):t.concat(n)}),[])}(e),r=0;r<n.length;r++){var i=n[r];if(null!=i){if(!s.isString(i))throw new TypeError("Bookmark value should be a string, given: '".concat(i,"'"));t.push(i)}}return t}throw new TypeError("Bookmark should either be a string or a string array, given: '".concat(e,"'"))}(t)}return(0,u.default)(e,[{key:"isEmpty",value:function(){return 0===this._values.length}},{key:"values",value:function(){return this._values}},{key:"asBeginTransactionParameters",value:function(){return this.isEmpty()?{}:(0,o.default)({},"bookmarks",this._values)}}],[{key:"empty",value:function(){return l}}]),e}();t.default=c;var l=new c(null)}}]);